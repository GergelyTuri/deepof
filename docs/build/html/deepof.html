<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>deepof package &mdash; deepof 0.1.85 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/deepof.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> deepof
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">deepof package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-deepof.data">deepof.data module</a><ul>
<li><a class="reference internal" href="#deepof.data.Project"><code class="docutils literal notranslate"><span class="pre">Project</span></code></a><ul>
<li><a class="reference internal" href="#deepof.data.Project.__init__"><code class="docutils literal notranslate"><span class="pre">Project.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.get_arena"><code class="docutils literal notranslate"><span class="pre">Project.get_arena()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.load_tables"><code class="docutils literal notranslate"><span class="pre">Project.load_tables()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.get_distances"><code class="docutils literal notranslate"><span class="pre">Project.get_distances()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.get_angles"><code class="docutils literal notranslate"><span class="pre">Project.get_angles()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.run"><code class="docutils literal notranslate"><span class="pre">Project.run()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.distances"><code class="docutils literal notranslate"><span class="pre">Project.distances</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.ego"><code class="docutils literal notranslate"><span class="pre">Project.ego</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Project.angles"><code class="docutils literal notranslate"><span class="pre">Project.angles</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.data.Coordinates"><code class="docutils literal notranslate"><span class="pre">Coordinates</span></code></a><ul>
<li><a class="reference internal" href="#deepof.data.Coordinates.__init__"><code class="docutils literal notranslate"><span class="pre">Coordinates.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_coords"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_coords()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_distances"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_distances()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_angles"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_angles()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_areas"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_areas()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_videos"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_videos()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_exp_conditions"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_exp_conditions</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_quality"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_quality()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.get_arenas"><code class="docutils literal notranslate"><span class="pre">Coordinates.get_arenas</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.supervised_annotation"><code class="docutils literal notranslate"><span class="pre">Coordinates.supervised_annotation()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.Coordinates.deep_unsupervised_embedding"><code class="docutils literal notranslate"><span class="pre">Coordinates.deep_unsupervised_embedding()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.data.TableDict"><code class="docutils literal notranslate"><span class="pre">TableDict</span></code></a><ul>
<li><a class="reference internal" href="#deepof.data.TableDict.__init__"><code class="docutils literal notranslate"><span class="pre">TableDict.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.filter_videos"><code class="docutils literal notranslate"><span class="pre">TableDict.filter_videos()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.plot_heatmaps"><code class="docutils literal notranslate"><span class="pre">TableDict.plot_heatmaps()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.random_projection"><code class="docutils literal notranslate"><span class="pre">TableDict.random_projection()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.pca"><code class="docutils literal notranslate"><span class="pre">TableDict.pca()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.tsne"><code class="docutils literal notranslate"><span class="pre">TableDict.tsne()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.filter_id"><code class="docutils literal notranslate"><span class="pre">TableDict.filter_id()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.merge"><code class="docutils literal notranslate"><span class="pre">TableDict.merge()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.get_training_set"><code class="docutils literal notranslate"><span class="pre">TableDict.get_training_set()</span></code></a></li>
<li><a class="reference internal" href="#deepof.data.TableDict.preprocess"><code class="docutils literal notranslate"><span class="pre">TableDict.preprocess()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#deepof-deepof-train-embeddings-module">deepof.deepof_train_embeddings module</a></li>
<li><a class="reference internal" href="#module-deepof.hypermodels">deepof.hypermodels module</a><ul>
<li><a class="reference internal" href="#deepof.hypermodels.VQVAE"><code class="docutils literal notranslate"><span class="pre">VQVAE</span></code></a><ul>
<li><a class="reference internal" href="#deepof.hypermodels.VQVAE.__init__"><code class="docutils literal notranslate"><span class="pre">VQVAE.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.hypermodels.VQVAE.get_hparams"><code class="docutils literal notranslate"><span class="pre">VQVAE.get_hparams()</span></code></a></li>
<li><a class="reference internal" href="#deepof.hypermodels.VQVAE.build"><code class="docutils literal notranslate"><span class="pre">VQVAE.build()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.hypermodels.GMVAE"><code class="docutils literal notranslate"><span class="pre">GMVAE</span></code></a><ul>
<li><a class="reference internal" href="#deepof.hypermodels.GMVAE.__init__"><code class="docutils literal notranslate"><span class="pre">GMVAE.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.hypermodels.GMVAE.get_hparams"><code class="docutils literal notranslate"><span class="pre">GMVAE.get_hparams()</span></code></a></li>
<li><a class="reference internal" href="#deepof.hypermodels.GMVAE.build"><code class="docutils literal notranslate"><span class="pre">GMVAE.build()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof.models">deepof.models module</a><ul>
<li><a class="reference internal" href="#deepof.models.get_recurrent_encoder"><code class="docutils literal notranslate"><span class="pre">get_recurrent_encoder()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.get_recurrent_decoder"><code class="docutils literal notranslate"><span class="pre">get_recurrent_decoder()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.get_TCN_encoder"><code class="docutils literal notranslate"><span class="pre">get_TCN_encoder()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.get_TCN_decoder"><code class="docutils literal notranslate"><span class="pre">get_TCN_decoder()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.get_transformer_encoder"><code class="docutils literal notranslate"><span class="pre">get_transformer_encoder()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.get_transformer_decoder"><code class="docutils literal notranslate"><span class="pre">get_transformer_decoder()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VectorQuantizer"><code class="docutils literal notranslate"><span class="pre">VectorQuantizer</span></code></a><ul>
<li><a class="reference internal" href="#deepof.models.VectorQuantizer.__init__"><code class="docutils literal notranslate"><span class="pre">VectorQuantizer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VectorQuantizer.call"><code class="docutils literal notranslate"><span class="pre">VectorQuantizer.call()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VectorQuantizer.get_code_indices"><code class="docutils literal notranslate"><span class="pre">VectorQuantizer.get_code_indices()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.models.get_vqvae"><code class="docutils literal notranslate"><span class="pre">get_vqvae()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VQVAE"><code class="docutils literal notranslate"><span class="pre">VQVAE</span></code></a><ul>
<li><a class="reference internal" href="#deepof.models.VQVAE.__init__"><code class="docutils literal notranslate"><span class="pre">VQVAE.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VQVAE.call"><code class="docutils literal notranslate"><span class="pre">VQVAE.call()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VQVAE.metrics"><code class="docutils literal notranslate"><span class="pre">VQVAE.metrics</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VQVAE.train_step"><code class="docutils literal notranslate"><span class="pre">VQVAE.train_step()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.VQVAE.test_step"><code class="docutils literal notranslate"><span class="pre">VQVAE.test_step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.models.GaussianMixtureLatent"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureLatent</span></code></a><ul>
<li><a class="reference internal" href="#deepof.models.GaussianMixtureLatent.__init__"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureLatent.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GaussianMixtureLatent.update_prior"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureLatent.update_prior()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GaussianMixtureLatent.call"><code class="docutils literal notranslate"><span class="pre">GaussianMixtureLatent.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.models.get_gmvae"><code class="docutils literal notranslate"><span class="pre">get_gmvae()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE"><code class="docutils literal notranslate"><span class="pre">GMVAE</span></code></a><ul>
<li><a class="reference internal" href="#deepof.models.GMVAE.__init__"><code class="docutils literal notranslate"><span class="pre">GMVAE.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE.metrics"><code class="docutils literal notranslate"><span class="pre">GMVAE.metrics</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE.prior"><code class="docutils literal notranslate"><span class="pre">GMVAE.prior</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE.update_prior"><code class="docutils literal notranslate"><span class="pre">GMVAE.update_prior()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE.call"><code class="docutils literal notranslate"><span class="pre">GMVAE.call()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE.train_step"><code class="docutils literal notranslate"><span class="pre">GMVAE.train_step()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.GMVAE.test_step"><code class="docutils literal notranslate"><span class="pre">GMVAE.test_step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.models.Contrastive"><code class="docutils literal notranslate"><span class="pre">Contrastive</span></code></a><ul>
<li><a class="reference internal" href="#deepof.models.Contrastive.__init__"><code class="docutils literal notranslate"><span class="pre">Contrastive.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.Contrastive.metrics"><code class="docutils literal notranslate"><span class="pre">Contrastive.metrics</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.Contrastive.call"><code class="docutils literal notranslate"><span class="pre">Contrastive.call()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.Contrastive.train_step"><code class="docutils literal notranslate"><span class="pre">Contrastive.train_step()</span></code></a></li>
<li><a class="reference internal" href="#deepof.models.Contrastive.test_step"><code class="docutils literal notranslate"><span class="pre">Contrastive.test_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof.post_hoc">deepof.post_hoc module</a><ul>
<li><a class="reference internal" href="#deepof.post_hoc.get_time_on_cluster"><code class="docutils literal notranslate"><span class="pre">get_time_on_cluster()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.get_aggregated_embedding"><code class="docutils literal notranslate"><span class="pre">get_aggregated_embedding()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.select_time_bin"><code class="docutils literal notranslate"><span class="pre">select_time_bin()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.condition_distance_binning"><code class="docutils literal notranslate"><span class="pre">condition_distance_binning()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.separation_between_conditions"><code class="docutils literal notranslate"><span class="pre">separation_between_conditions()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.cluster_enrichment_across_conditions"><code class="docutils literal notranslate"><span class="pre">cluster_enrichment_across_conditions()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.get_transitions"><code class="docutils literal notranslate"><span class="pre">get_transitions()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.compute_transition_matrix_per_condition"><code class="docutils literal notranslate"><span class="pre">compute_transition_matrix_per_condition()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.compute_steady_state"><code class="docutils literal notranslate"><span class="pre">compute_steady_state()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.align_deepof_kinematics_with_unsupervised_labels"><code class="docutils literal notranslate"><span class="pre">align_deepof_kinematics_with_unsupervised_labels()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.chunk_summary_statistics"><code class="docutils literal notranslate"><span class="pre">chunk_summary_statistics()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.annotate_time_chunks"><code class="docutils literal notranslate"><span class="pre">annotate_time_chunks()</span></code></a></li>
<li><a class="reference internal" href="#deepof.post_hoc.chunk_cv_splitter"><code class="docutils literal notranslate"><span class="pre">chunk_cv_splitter()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof.supervised_utils">deepof.supervised_utils module</a><ul>
<li><a class="reference internal" href="#deepof.supervised_utils.close_single_contact"><code class="docutils literal notranslate"><span class="pre">close_single_contact()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.close_double_contact"><code class="docutils literal notranslate"><span class="pre">close_double_contact()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.rotate"><code class="docutils literal notranslate"><span class="pre">rotate()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.outside_ellipse"><code class="docutils literal notranslate"><span class="pre">outside_ellipse()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.climb_wall"><code class="docutils literal notranslate"><span class="pre">climb_wall()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.sniff_object"><code class="docutils literal notranslate"><span class="pre">sniff_object()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.huddle"><code class="docutils literal notranslate"><span class="pre">huddle()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.dig"><code class="docutils literal notranslate"><span class="pre">dig()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.look_around"><code class="docutils literal notranslate"><span class="pre">look_around()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.following_path"><code class="docutils literal notranslate"><span class="pre">following_path()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.max_behaviour"><code class="docutils literal notranslate"><span class="pre">max_behaviour()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.get_hparameters"><code class="docutils literal notranslate"><span class="pre">get_hparameters()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.frame_corners"><code class="docutils literal notranslate"><span class="pre">frame_corners()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.supervised_tagging"><code class="docutils literal notranslate"><span class="pre">supervised_tagging()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.tag_annotated_frames"><code class="docutils literal notranslate"><span class="pre">tag_annotated_frames()</span></code></a></li>
<li><a class="reference internal" href="#deepof.supervised_utils.annotate_video"><code class="docutils literal notranslate"><span class="pre">annotate_video()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof.unsupervised_utils">deepof.unsupervised_utils module</a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.select_contrastive_loss"><code class="docutils literal notranslate"><span class="pre">select_contrastive_loss()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.nce_loss_fn"><code class="docutils literal notranslate"><span class="pre">nce_loss_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.dcl_loss_fn"><code class="docutils literal notranslate"><span class="pre">dcl_loss_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.fc_loss_fn"><code class="docutils literal notranslate"><span class="pre">fc_loss_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.hard_loss_fn"><code class="docutils literal notranslate"><span class="pre">hard_loss_fn()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.load_treatments"><code class="docutils literal notranslate"><span class="pre">load_treatments()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.compute_kmeans_loss"><code class="docutils literal notranslate"><span class="pre">compute_kmeans_loss()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.get_k_nearest_neighbors"><code class="docutils literal notranslate"><span class="pre">get_k_nearest_neighbors()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.compute_shannon_entropy"><code class="docutils literal notranslate"><span class="pre">compute_shannon_entropy()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.get_neighbourhood_entropy"><code class="docutils literal notranslate"><span class="pre">get_neighbourhood_entropy()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.plot_lr_vs_loss"><code class="docutils literal notranslate"><span class="pre">plot_lr_vs_loss()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.get_angles"><code class="docutils literal notranslate"><span class="pre">get_angles()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.positional_encoding"><code class="docutils literal notranslate"><span class="pre">positional_encoding()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.create_padding_mask"><code class="docutils literal notranslate"><span class="pre">create_padding_mask()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.create_look_ahead_mask"><code class="docutils literal notranslate"><span class="pre">create_look_ahead_mask()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.create_masks"><code class="docutils literal notranslate"><span class="pre">create_masks()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.find_learning_rate"><code class="docutils literal notranslate"><span class="pre">find_learning_rate()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.get_hard_counts"><code class="docutils literal notranslate"><span class="pre">get_hard_counts()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.cluster_frequencies_regularizer"><code class="docutils literal notranslate"><span class="pre">cluster_frequencies_regularizer()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.get_callbacks"><code class="docutils literal notranslate"><span class="pre">get_callbacks()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.CustomStopper"><code class="docutils literal notranslate"><span class="pre">CustomStopper</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.CustomStopper.__init__"><code class="docutils literal notranslate"><span class="pre">CustomStopper.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.CustomStopper.get_config"><code class="docutils literal notranslate"><span class="pre">CustomStopper.get_config()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.CustomStopper.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">CustomStopper.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ExponentialLearningRate"><code class="docutils literal notranslate"><span class="pre">ExponentialLearningRate</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ExponentialLearningRate.__init__"><code class="docutils literal notranslate"><span class="pre">ExponentialLearningRate.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ExponentialLearningRate.on_batch_end"><code class="docutils literal notranslate"><span class="pre">ExponentialLearningRate.on_batch_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ProbabilisticDecoder"><code class="docutils literal notranslate"><span class="pre">ProbabilisticDecoder</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ProbabilisticDecoder.__init__"><code class="docutils literal notranslate"><span class="pre">ProbabilisticDecoder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ProbabilisticDecoder.call"><code class="docutils literal notranslate"><span class="pre">ProbabilisticDecoder.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ClusterControl"><code class="docutils literal notranslate"><span class="pre">ClusterControl</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ClusterControl.__init__"><code class="docutils literal notranslate"><span class="pre">ClusterControl.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ClusterControl.get_config"><code class="docutils literal notranslate"><span class="pre">ClusterControl.get_config()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.ClusterControl.call"><code class="docutils literal notranslate"><span class="pre">ClusterControl.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.KLDivergenceLayer"><code class="docutils literal notranslate"><span class="pre">KLDivergenceLayer</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.KLDivergenceLayer.__init__"><code class="docutils literal notranslate"><span class="pre">KLDivergenceLayer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.KLDivergenceLayer.get_config"><code class="docutils literal notranslate"><span class="pre">KLDivergenceLayer.get_config()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.KLDivergenceLayer.call"><code class="docutils literal notranslate"><span class="pre">KLDivergenceLayer.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerEncoderLayer"><code class="docutils literal notranslate"><span class="pre">TransformerEncoderLayer</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerEncoderLayer.__init__"><code class="docutils literal notranslate"><span class="pre">TransformerEncoderLayer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerEncoderLayer.call"><code class="docutils literal notranslate"><span class="pre">TransformerEncoderLayer.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerDecoderLayer"><code class="docutils literal notranslate"><span class="pre">TransformerDecoderLayer</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerDecoderLayer.__init__"><code class="docutils literal notranslate"><span class="pre">TransformerDecoderLayer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerDecoderLayer.call"><code class="docutils literal notranslate"><span class="pre">TransformerDecoderLayer.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerEncoder"><code class="docutils literal notranslate"><span class="pre">TransformerEncoder</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerEncoder.__init__"><code class="docutils literal notranslate"><span class="pre">TransformerEncoder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerEncoder.call"><code class="docutils literal notranslate"><span class="pre">TransformerEncoder.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerDecoder"><code class="docutils literal notranslate"><span class="pre">TransformerDecoder</span></code></a><ul>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerDecoder.__init__"><code class="docutils literal notranslate"><span class="pre">TransformerDecoder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.TransformerDecoder.call"><code class="docutils literal notranslate"><span class="pre">TransformerDecoder.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.log_hyperparameters"><code class="docutils literal notranslate"><span class="pre">log_hyperparameters()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.autoencoder_fitting"><code class="docutils literal notranslate"><span class="pre">autoencoder_fitting()</span></code></a></li>
<li><a class="reference internal" href="#deepof.unsupervised_utils.tune_search"><code class="docutils literal notranslate"><span class="pre">tune_search()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof.utils">deepof.utils module</a><ul>
<li><a class="reference internal" href="#deepof.utils.connect_mouse_topview"><code class="docutils literal notranslate"><span class="pre">connect_mouse_topview()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.str2bool"><code class="docutils literal notranslate"><span class="pre">str2bool()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.likelihood_qc"><code class="docutils literal notranslate"><span class="pre">likelihood_qc()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.bp2polar"><code class="docutils literal notranslate"><span class="pre">bp2polar()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.tab2polar"><code class="docutils literal notranslate"><span class="pre">tab2polar()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.compute_dist"><code class="docutils literal notranslate"><span class="pre">compute_dist()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.bpart_distance"><code class="docutils literal notranslate"><span class="pre">bpart_distance()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.angle"><code class="docutils literal notranslate"><span class="pre">angle()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.angle_trio"><code class="docutils literal notranslate"><span class="pre">angle_trio()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.compute_areas"><code class="docutils literal notranslate"><span class="pre">compute_areas()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.rotate"><code class="docutils literal notranslate"><span class="pre">rotate()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.align_trajectories"><code class="docutils literal notranslate"><span class="pre">align_trajectories()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.kleinberg"><code class="docutils literal notranslate"><span class="pre">kleinberg()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.smooth_boolean_array"><code class="docutils literal notranslate"><span class="pre">smooth_boolean_array()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.split_with_breakpoints"><code class="docutils literal notranslate"><span class="pre">split_with_breakpoints()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.rolling_window"><code class="docutils literal notranslate"><span class="pre">rolling_window()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.rupture_per_experiment"><code class="docutils literal notranslate"><span class="pre">rupture_per_experiment()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.smooth_mult_trajectory"><code class="docutils literal notranslate"><span class="pre">smooth_mult_trajectory()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.moving_average"><code class="docutils literal notranslate"><span class="pre">moving_average()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.mask_outliers"><code class="docutils literal notranslate"><span class="pre">mask_outliers()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.full_outlier_mask"><code class="docutils literal notranslate"><span class="pre">full_outlier_mask()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.interpolate_outliers"><code class="docutils literal notranslate"><span class="pre">interpolate_outliers()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.filter_columns"><code class="docutils literal notranslate"><span class="pre">filter_columns()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.automatically_recognize_arena"><code class="docutils literal notranslate"><span class="pre">automatically_recognize_arena()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.retrieve_corners_from_image"><code class="docutils literal notranslate"><span class="pre">retrieve_corners_from_image()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.extract_polygonal_arena_coordinates"><code class="docutils literal notranslate"><span class="pre">extract_polygonal_arena_coordinates()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.fit_ellipse_to_polygon"><code class="docutils literal notranslate"><span class="pre">fit_ellipse_to_polygon()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.circular_arena_recognition"><code class="docutils literal notranslate"><span class="pre">circular_arena_recognition()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.rolling_speed"><code class="docutils literal notranslate"><span class="pre">rolling_speed()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.gmm_compute"><code class="docutils literal notranslate"><span class="pre">gmm_compute()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.gmm_model_selection"><code class="docutils literal notranslate"><span class="pre">gmm_model_selection()</span></code></a></li>
<li><a class="reference internal" href="#deepof.utils.cluster_transition_matrix"><code class="docutils literal notranslate"><span class="pre">cluster_transition_matrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof.visuals">deepof.visuals module</a><ul>
<li><a class="reference internal" href="#deepof.visuals.plot_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_heatmap()</span></code></a></li>
<li><a class="reference internal" href="#deepof.visuals.plot_projection"><code class="docutils literal notranslate"><span class="pre">plot_projection()</span></code></a></li>
<li><a class="reference internal" href="#deepof.visuals.plot_unsupervised_embeddings"><code class="docutils literal notranslate"><span class="pre">plot_unsupervised_embeddings()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-deepof">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">deepof</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>deepof package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/deepof.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="deepof-package">
<h1>deepof package<a class="headerlink" href="#deepof-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-deepof.data">
<span id="deepof-data-module"></span><h2>deepof.data module<a class="headerlink" href="#module-deepof.data" title="Permalink to this heading"></a></h2>
<p>Data structures for preprocessing and wrangling of DLC output data. This is the main module handled by the user.
There are three main data structures to pay attention to:
- <a class="reference internal" href="#deepof.data.Project" title="deepof.data.Project"><code class="xref py py-class docutils literal notranslate"><span class="pre">Project</span></code></a>, which serves as a configuration hub for the whole pipeline
- <a class="reference internal" href="#deepof.data.Coordinates" title="deepof.data.Coordinates"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coordinates</span></code></a>, which acts as an intermediary between project configuration and data, and contains
a plethora of processing methods to apply, and
- <a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableDict</span></code></a>, which is the main data structure to store the data, having experiment IDs as keys
and processed time-series as values in a dictionary-like object.</p>
<p>For a detailed tutorial on how to use this module, see the advanced tutorials in the main section.</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepof.data.Project">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.data.</span></span><span class="sig-name descname"><span class="pre">Project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arena_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'polygonal-manual'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_detection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rule-based'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_iterative_imputation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_bodyparts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_fidelity_arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_outliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mouse_topview'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'autodetect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.mp4'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.Project" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for loading and preprocessing DLC data of individual and multiple animals. All main computations are
handled from here.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Project.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arena_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'polygonal-manual'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_detection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rule-based'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_iterative_imputation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_bodyparts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_fidelity_arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_outliers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mouse_topview'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'autodetect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.mp4'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.Project.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes a Project object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arena_dims</strong> (<em>int</em>) – diameter of the arena in mm (so far, only round arenas are supported).</p></li>
<li><p><strong>animal_ids</strong> (<em>list</em>) – list of animal ids.</p></li>
<li><p><strong>arena</strong> (<em>str</em>) – arena type. Can be one of “circular-autodetect”, “circular-manual”, or “polygon-manual”.</p></li>
<li><p><strong>arena_detection</strong> (<em>str</em>) – method for detecting the arena (must be either ‘rule-based’ (default) or ‘cnn’).</p></li>
<li><p><strong>enable_iterative_imputation</strong> (<em>bool</em>) – whether to use iterative imputation for occluded body parts. Recommended,</p></li>
<li><p><strong>slow.</strong> (<em>but</em>) – </p></li>
<li><p><strong>exclude_bodyparts</strong> (<em>list</em>) – list of bodyparts to exclude from analysis.</p></li>
<li><p><strong>exp_conditions</strong> (<em>dict</em>) – dictionary with experiment IDs as keys and experimental conditions as values.</p></li>
<li><p><strong>high_fidelity_arena</strong> (<em>bool</em>) – whether to use high-fidelity arena detection. Recommended if light conditions</p></li>
<li><p><strong>videos.</strong> (<em>are uneven across</em>) – </p></li>
<li><p><strong>interpolate_outliers</strong> (<em>bool</em>) – whether to interpolate missing data.</p></li>
<li><p><strong>interpolation_limit</strong> (<em>int</em>) – maximum number of missing frames to interpolate.</p></li>
<li><p><strong>interpolation_std</strong> (<em>int</em>) – maximum number of standard deviations to interpolate.</p></li>
<li><p><strong>likelihood_tol</strong> (<em>float</em>) – likelihood threshold for outlier detection.</p></li>
<li><p><strong>model</strong> (<em>str</em>) – model to use for pose estimation. Defaults to ‘mouse_topview’ (as described in the documentation).</p></li>
<li><p><strong>path</strong> (<em>str</em>) – path to the folder containing the DLC output data.</p></li>
<li><p><strong>smooth_alpha</strong> (<em>float</em>) – smoothing intensity. The higher the value, the more smoothing.</p></li>
<li><p><strong>table_format</strong> (<em>str</em>) – format of the table. Defaults to ‘autodetect’, but can be set to “csv” or “h5”.</p></li>
<li><p><strong>frame_rate</strong> (<em>int</em>) – frame rate of the videos. If not specified, it will be inferred from the video files.</p></li>
<li><p><strong>video_format</strong> (<em>str</em>) – video format. Defaults to ‘.mp4’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Project.get_arena">
<span class="sig-name descname"><span class="pre">get_arena</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.data.Project.get_arena" title="Permalink to this definition"></a></dt>
<dd><p>Returns the arena as recognised from the videos</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tables</strong> (<em>list</em>) – list of coordinate tables</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – if True, logs to console</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>arena parameters, as recognised from the videos. The shape depends on the arena type</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>arena (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Project.load_tables">
<span class="sig-name descname"><span class="pre">load_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="headerlink" href="#deepof.data.Project.load_tables" title="Permalink to this definition"></a></dt>
<dd><p>Loads videos and tables into dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>) – If True, prints the progress of data loading.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the following a dictionary with all loaded tables per experiment,
and another dictionary with DLC data quality.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Project.get_distances">
<span class="sig-name descname"><span class="pre">get_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tab_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#deepof.data.Project.get_distances" title="Permalink to this definition"></a></dt>
<dd><p>Computes the distances between all selected body parts over time. If ego is provided, it only returns
distances to a specified bodypart.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tab_dict</strong> (<em>dict</em>) – Dictionary of pandas DataFrames containing the trajectories of all bodyparts.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints progress. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of pandas DataFrames containing the distances between all bodyparts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Project.get_angles">
<span class="sig-name descname"><span class="pre">get_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tab_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#deepof.data.Project.get_angles" title="Permalink to this definition"></a></dt>
<dd><p>Computes all the angles between adjacent bodypart trios per video and per frame in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tab_dict</strong> (<em>dict</em>) – Dictionary of pandas DataFrames containing the trajectories of all bodyparts.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints progress. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of pandas DataFrames containing the distances between all bodyparts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Project.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_coordinates</span></span></span><a class="headerlink" href="#deepof.data.Project.run" title="Permalink to this definition"></a></dt>
<dd><p>Generates a deepof.Coordinates dataset using all the options specified during initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>) – If True, prints progress. Defaults to True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Deepof.Coordinates object containing the trajectories of all bodyparts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.data.Project.distances">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">distances</span></span><a class="headerlink" href="#deepof.data.Project.distances" title="Permalink to this definition"></a></dt>
<dd><p>List. If not ‘all’, sets the body parts among which the
distances will be computed</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.data.Project.ego">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ego</span></span><a class="headerlink" href="#deepof.data.Project.ego" title="Permalink to this definition"></a></dt>
<dd><p>String, name of a body part. If True, computes only the distances
between the specified body part and the rest</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.data.Project.angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angles</span></span><a class="headerlink" href="#deepof.data.Project.angles" title="Permalink to this definition"></a></dt>
<dd><p>Bool. Toggles angle computation. True by default. If turned off,
enhances performance for big datasets</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.data.Coordinates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.data.</span></span><span class="sig-name descname"><span class="pre">Coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_detection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trained_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">videos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.Coordinates" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for storing the results of a ran project. Methods are mostly setters and getters in charge of tidying up
the generated tables.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_detection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trained_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">videos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('',)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.Coordinates.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Class for storing the results of a ran project. Methods are mostly setters and getters in charge of tidying up
the generated tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arena</strong> (<em>str</em>) – Type of arena used for the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>arena_detection</strong> (<em>str</em>) – Type of arena detection used for the experiment. See deepof.data.Project for more</p></li>
<li><p><strong>information.</strong> (<em>See deepof.data.Project for more</em>) – </p></li>
<li><p><strong>arena_dims</strong> (<em>np.array</em>) – Dimensions of the arena. See deepof.data.Project for more information.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to the folder containing the results of the experiment.</p></li>
<li><p><strong>quality</strong> (<em>dict</em>) – Dictionary containing the quality of the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>scales</strong> (<em>np.ndarray</em>) – Scales used for the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>arena_params</strong> (<em>List</em>) – List containing the parameters of the arena. See deepof.data.Project for more information.</p></li>
<li><p><strong>tables</strong> (<em>dict</em>) – Dictionary containing the tables of the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>trained_model_path</strong> (<em>str</em>) – Path to the trained models used for the supervised pipeline. For internal use only.</p></li>
<li><p><strong>videos</strong> (<em>List</em>) – List containing the videos used for the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>video_resolution</strong> (<em>List</em>) – List containing the automatically detected resolution of the videos used for the experiment.</p></li>
<li><p><strong>angles</strong> (<em>dict</em>) – Dictionary containing the angles of the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>animal_ids</strong> (<em>List</em>) – List containing the animal IDs of the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>distances</strong> (<em>dict</em>) – Dictionary containing the distances of the experiment. See deepof.data.Project for more information.</p></li>
<li><p><strong>exp_conditions</strong> (<em>dict</em>) – Dictionary containing the experimental conditions of the experiment.</p></li>
<li><p><strong>information.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_coords">
<span class="sig-name descname"><span class="pre">get_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'arena'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_inplace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.Coordinates.get_coords" title="Permalink to this definition"></a></dt>
<dd><p>Returns a table_dict object with the coordinates of each animal as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>str</em>) – Name of the body part to which the positions will be centered. If false,</p></li>
<li><p><strong>'arena'</strong> (<em>the raw data is returned; if</em>) – </p></li>
<li><p><strong>polar</strong> (<em>bool</em>) – </p></li>
<li><p><strong>speed</strong> (<em>int</em>) – States the derivative of the positions to report. Speed is returned if 1, acceleration if 2,</p></li>
<li><p><strong>3</strong> (<em>jerk if</em>) – </p></li>
<li><p><strong>etc.</strong> – </p></li>
<li><p><strong>align</strong> (<em>str</em>) – Selects the body part to which later processes will align the frames with</p></li>
<li><p><strong>documentation</strong><strong>)</strong><strong>.</strong> (<em>(</em><em>see preprocess in table_dict</em>) – </p></li>
<li><p><strong>align_inplace</strong> (<em>bool</em>) – Only valid if align is set. Aligns the vector that goes from the origin to the</p></li>
<li><p><strong>axis</strong> (<em>selected body part with the y</em>) – </p></li>
<li><p><strong>points</strong> (<em>for all time</em>) – </p></li>
<li><p><strong>selected_id</strong> (<em>str</em>) – Selects a single animal on multi animal settings. Defaults to None (all animals are processed).</p></li>
<li><p><strong>propagate_labels</strong> (<em>bool</em>) – If True, adds an extra feature for each video containing its phenotypic label</p></li>
<li><p><strong>propagate_annotations</strong> (<em>dict</em>) – If a dictionary is provided, supervised annotations are propagated through</p></li>
<li><p><strong>traits.</strong> (<em>the training dataset. This can be used for regularising the latent space based on already known</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A table_dict object containing the coordinates of each animal as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_distances">
<span class="sig-name descname"><span class="pre">get_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.Coordinates.get_distances" title="Permalink to this definition"></a></dt>
<dd><p>Returns a table_dict object with the distances between body parts animal as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>speed</strong> (<em>int</em>) – The derivative to use for speed.</p></li>
<li><p><strong>selected_id</strong> (<em>str</em>) – The id of the animal to select.</p></li>
<li><p><strong>propagate_labels</strong> (<em>bool</em>) – If True, the pheno column will be propagated from the original data.</p></li>
<li><p><strong>propagate_annotations</strong> (<em>Dict</em>) – A dictionary of annotations to propagate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A table_dict object with the distances between body parts animal as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_angles">
<span class="sig-name descname"><span class="pre">get_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degrees</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.Coordinates.get_angles" title="Permalink to this definition"></a></dt>
<dd><p>Returns a table_dict object with the angles between body parts animal as values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>degrees</strong> (<em>bool</em>) – If True (default), the angles will be in degrees. Otherwise they will be converted to radians.</p></li>
<li><p><strong>speed</strong> (<em>int</em>) – The derivative to use for speed.</p></li>
<li><p><strong>selected_id</strong> (<em>str</em>) – The id of the animal to select.</p></li>
<li><p><strong>propagate_labels</strong> (<em>bool</em>) – If True, the pheno column will be propagated from the original data.</p></li>
<li><p><strong>propagate_annotations</strong> (<em>Dict</em>) – A dictionary of annotations to propagate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A table_dict object with the angles between body parts animal as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_areas">
<span class="sig-name descname"><span class="pre">get_areas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.Coordinates.get_areas" title="Permalink to this definition"></a></dt>
<dd><p>Returns a table_dict object with all relevant areas (head, torso, back, full). Unless specified otherwise,
the areas are computed for all animals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>speed</strong> (<em>int</em>) – The derivative to use for speed.</p></li>
<li><p><strong>selected_id</strong> (<em>str</em>) – The id of the animal to select. “all” (default) computes the areas for all animals.</p></li>
<li><p><strong>self._animal_ids.</strong> (<em>declared in</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A table_dict object with the areas of the body parts animal as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_videos">
<span class="sig-name descname"><span class="pre">get_videos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">play</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.Coordinates.get_videos" title="Permalink to this definition"></a></dt>
<dd><p>Retuens the videos associated with the dataset as a list.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_exp_conditions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_exp_conditions</span></span><a class="headerlink" href="#deepof.data.Coordinates.get_exp_conditions" title="Permalink to this definition"></a></dt>
<dd><p>Returns the stored dictionary with experimental conditions per subject</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_quality">
<span class="sig-name descname"><span class="pre">get_quality</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.Coordinates.get_quality" title="Permalink to this definition"></a></dt>
<dd><p>Retrieves a dictionary with the tagging quality per video, as reported by DLC</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.data.Coordinates.get_arenas">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_arenas</span></span><a class="headerlink" href="#deepof.data.Coordinates.get_arenas" title="Permalink to this definition"></a></dt>
<dd><p>Retrieves all available information associated with the arena</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.supervised_annotation">
<span class="sig-name descname"><span class="pre">supervised_annotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.Coordinates.supervised_annotation" title="Permalink to this definition"></a></dt>
<dd><p>Annotates coordinates with behavioral traits using a supervised pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Dict</em>) – A dictionary with the parameters to use for the pipeline. If unsure, leave empty.</p></li>
<li><p><strong>video_output</strong> (<em>bool</em>) – It outputs a fully annotated video for each experiment indicated in a list. If set to</p></li>
<li><p><strong>&quot;all&quot;</strong> – </p></li>
<li><p><strong>default.</strong> (<em>it will output all videos. False by</em>) – </p></li>
<li><p><strong>frame_limit</strong> (<em>int</em>) – Only applies if video_output is not False. Indicates the maximum number of frames per</p></li>
<li><p><strong>output.</strong> (<em>video to</em>) – </p></li>
<li><p><strong>debug</strong> (<em>bool</em>) – Only applies if video_output is not False. If True, all videos will include debug information,</p></li>
<li><p><strong>tags.</strong> (<em>such as the detected arena and the preprocessed tracking</em>) – </p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – Number of jobs to use for parallel processing.</p></li>
<li><p><strong>propagate_labels</strong> (<em>bool</em>) – If True, the pheno column will be propagated from the original data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A table_dict object with all supervised annotations per experiment as values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.Coordinates.deep_unsupervised_embedding">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">deep_unsupervised_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'VQVAE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'unsupervised_trained_models'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Strategy</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'one_device'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_annealing_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cat_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="headerlink" href="#deepof.data.Coordinates.deep_unsupervised_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Annotates coordinates using a deep unsupervised autoencoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_object</strong> (<em>tuple</em>) – Tuple containing a preprocessed object (X_train, y_train, X_test, y_test).</p></li>
<li><p><strong>embedding_model</strong> (<em>str</em>) – Name of the embedding model to use. Must be one of VQVAE (default), GMVAE, or contrastive.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimention size of the latent space.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Maximum number of epochs to train the model. Actual training might be shorter, as the model</p></li>
<li><p><strong>decreasing.</strong> (<em>will stop training when validation loss stops</em>) – </p></li>
<li><p><strong>log_history</strong> (<em>bool</em>) – Whether to log the history of the model to TensorBoard.</p></li>
<li><p><strong>log_hparams</strong> (<em>bool</em>) – Whether to log the hyperparameters of the model to TensorBoard.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of latent clusters for the embedding model to use.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – Weight of the gram loss, which adds a regularization term to GMVAE and VQVAE models which</p></li>
<li><p><strong>space.</strong> (<em>penalizes the correlation between the dimensions in the latent</em>) – </p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – Path to save the trained model and all log files.</p></li>
<li><p><strong>pretrained</strong> (<em>str</em>) – Whether to load a pretrained model. If False, model is trained from scratch. If not,</p></li>
<li><p><strong>model.</strong> (<em>must be the path to a saved</em>) – </p></li>
<li><p><strong>save_checkpoints</strong> (<em>bool</em>) – Whether to save checkpoints of the model during training. Defaults to False.</p></li>
<li><p><strong>save_weights</strong> (<em>bool</em>) – Whether to save the weights of the model during training. Defaults to True.</p></li>
<li><p><strong>input_type</strong> (<em>str</em>) – Type of the preprocessed_object passed as the first parameter. See deepof.data.TableDict</p></li>
<li><p><strong>details.</strong> (<em>for more</em>) – </p></li>
<li><p><strong>run</strong> (<em>int</em>) – Run number for the model. Used to save the model and log files. Optional.</p></li>
<li><p><strong>strategy</strong> (<em>tf.distribute.Strategy</em>) – Distributed strategy for TensorFloe to use. Must be one of “one_device”,</p></li>
<li><p><strong>&quot;mirrored_strategy&quot;</strong> (<em>or</em>) – </p></li>
<li><p><strong>&quot;one_device&quot;.</strong> (<em>as</em>) – </p></li>
<li><p><strong>kl_annealing_mode</strong> (<em>str</em>) – Mode of the KL annealing. Must be one of “linear”, or “sigmoid”.</p></li>
<li><p><strong>kl_warmup</strong> (<em>int</em>) – Number of epochs to warm up the KL annealing.</p></li>
<li><p><strong>reg_cat_clusters</strong> (<em>bool</em>) – whether to use the penalize uneven cluster membership in the latent space, by</p></li>
<li><p><strong>distribution.</strong> (<em>minimizing the KL divergence between cluster membership and a uniform categorical</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing all trained models. See specific model documentation under deepof.models for details.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.data.TableDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.data.</span></span><span class="sig-name descname"><span class="pre">TableDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.TableDict" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Main class for storing a single dataset as a dictionary with individuals as keys and pandas.DataFrames as values.
Includes methods for generating training and testing datasets for the autoencoders.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.TableDict.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Main class for storing a single dataset as a dictionary with individuals as keys and pandas.DataFrames as values.
Includes methods for generating training and testing datasets for the autoencoders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabs</strong> (<em>Dict</em>) – Dictionary of pandas.DataFrames with individual experiments as keys.</p></li>
<li><p><strong>typ</strong> (<em>str</em>) – Type of the dataset. Examples are “coords”, “dists”, and “angles”. For logging purposes only.</p></li>
<li><p><strong>arena</strong> (<em>str</em>) – Type of the arena. Must be one of “circular-autodetect”, “circular-manual”, or “polygon-manual”. Handled internally.</p></li>
<li><p><strong>arena_dims</strong> (<em>np.array</em>) – Dimensions of the arena in mm.</p></li>
<li><p><strong>center</strong> (<em>str</em>) – Type of the center. Handled internally.</p></li>
<li><p><strong>polar</strong> (<em>bool</em>) – Whether the dataset is in polar coordinates. Handled internally.</p></li>
<li><p><strong>propagate_labels</strong> (<em>bool</em>) – Whether to propagate phenotypic labels from the original experiments to the</p></li>
<li><p><strong>dataset.</strong> (<em>of the individual experiments are propagated to the</em>) – </p></li>
<li><p><strong>propagate_annotations</strong> (<em>Dict</em>) – Dictionary of annotations to propagate. If provided, the supervised annotations</p></li>
<li><p><strong>dataset.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.filter_videos">
<span class="sig-name descname"><span class="pre">filter_videos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.TableDict.filter_videos" title="Permalink to this definition"></a></dt>
<dd><p>Returns a subset of the original table_dict object, containing only the specified keys. Useful, for example,
for selecting data coming from videos of a specified condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keys</strong> (<em>list</em>) – List of keys to keep.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Subset of the original table_dict object, containing only the specified keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict">TableDict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.plot_heatmaps">
<span class="sig-name descname"><span class="pre">plot_heatmaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bodyparts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">figure</span></span></span><a class="headerlink" href="#deepof.data.TableDict.plot_heatmaps" title="Permalink to this definition"></a></dt>
<dd><p>Plots heatmaps of the specified body parts (bodyparts) of the specified animal (i).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bodyparts</strong> (<em>list</em>) – list of body parts to plot.</p></li>
<li><p><strong>xlim</strong> (<em>float</em>) – x-axis limits.</p></li>
<li><p><strong>ylim</strong> (<em>float</em>) – y-axis limits.</p></li>
<li><p><strong>save</strong> (<em>str</em>) – if provided, the figure is saved to the specified path.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – index of the animal to plot.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – resolution of the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Figure object containing the heatmaps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>plt.figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.random_projection">
<span class="sig-name descname"><span class="pre">random_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.data.TableDict.random_projection" title="Permalink to this definition"></a></dt>
<dd><p>Returns a training set generated from the 2D original data (time x features) and a random projection
to a n_components space. The sample parameter allows the user to randomly pick a subset of the data for
performance or visualization reasons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components to project to. Default is 2.</p></li>
<li><p><strong>kernel</strong> (<em>str</em>) – Kernel to be used for projections. Defaults to linear.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing projected data and projection type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.pca">
<span class="sig-name descname"><span class="pre">pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.data.TableDict.pca" title="Permalink to this definition"></a></dt>
<dd><p>Returns a training set generated from the 2D original data (time x features) and a PCA projection
to a n_components space. The sample parameter allows the user to randomly pick a subset of the data for
performance or visualization reasons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components to project to. Default is 2.</p></li>
<li><p><strong>kernel</strong> (<em>str</em>) – Kernel to be used for projections. Defaults to linear.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing projected data and projection type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.tsne">
<span class="sig-name descname"><span class="pre">tsne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perplexity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.data.TableDict.tsne" title="Permalink to this definition"></a></dt>
<dd><p>Returns a training set generated from the 2D original data (time x features) and a PCA projection
to a n_components space. The sample parameter allows the user to randomly pick a subset of the data for
performance or visualization reasons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components to project to. Default is 2.</p></li>
<li><p><strong>perplexity</strong> (<em>int</em>) – Perplexity parameter for the t-SNE algorithm. Default is 30.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing projected data and projection type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.filter_id">
<span class="sig-name descname"><span class="pre">filter_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selected_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">deepof_table_dict</span></span></span><a class="headerlink" href="#deepof.data.TableDict.filter_id" title="Permalink to this definition"></a></dt>
<dd><p>Filters a TableDict object to keep only those columns related to the selected id. Leaves labels
untouched if present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selected_id</strong> (<em>str</em>) – select a single animal on multi animal settings. Defaults to None</p></li>
<li><p><strong>processed</strong><strong>)</strong><strong>.</strong> (<em>(</em><em>all animals are</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered TableDict object, keeping only the selected animal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.data.TableDict.merge" title="Permalink to this definition"></a></dt>
<dd><p>Takes a number of table_dict objects and merges them to the current one.
Returns a table_dict object of type ‘merged’.
Only annotations of the first table_dict object are kept.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>table_dict</em>) – table_dict objects to be merged.</p></li>
<li><p><strong>ignore_index</strong> (<em>bool</em>) – ignore index when merging. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged table_dict object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>table_dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.get_training_set">
<span class="sig-name descname"><span class="pre">get_training_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_table_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_videos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#deepof.data.TableDict.get_training_set" title="Permalink to this definition"></a></dt>
<dd><p>Generates training and test sets as numpy.array objects for model training. Intended for internal usage only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_table_dict</strong> (<em>table_dict</em>) – table_dict object containing the data to be used for training.</p></li>
<li><p><strong>test_videos</strong> (<em>int</em>) – Number of videos to be used for testing. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing training data, training labels (if any), test data, and test labels (if any).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.data.TableDict.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">automatic_changepoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rbf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_videos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_low_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_normalized</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precomputed_breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#deepof.data.TableDict.preprocess" title="Permalink to this definition"></a></dt>
<dd><p>Main method for preprocessing the loaded dataset before feeding to unsupervised embedding models.
Capable of returning training and test sets ready for model training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>automatic_changepoints</strong> (<em>str</em>) – specifies the changepoint detection kernel to use to rupture the</p></li>
<li><p><strong>&quot;rbf&quot;</strong> (<em>data across time using Pelt. Can be set to</em>) – </p></li>
<li><p><strong>appiled.</strong> – </p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – Minimum size of the applied ruptures. If automatic_changepoints is False,</p></li>
<li><p><strong>instances.</strong> (<em>specifies the size</em><em> of </em><em>the sliding window to pass through the data to generate training</em>) – </p></li>
<li><p><strong>window_step</strong> (<em>int</em>) – Specifies the minimum jump for the rupture algorithms. If automatic_changepoints is False,</p></li>
<li><p><strong>case</strong> (<em>specifies the step to take when sliding the aforementioned window. In this</em>) – </p></li>
<li><p><strong>indicates</strong> (<em>a value</em><em> of </em><em>1</em>) – </p></li>
<li><p><strong>window</strong> (<em>a true sliding</em>) – </p></li>
<li><p><strong>chunks.</strong> (<em>and a value equal to to window_size splits the data into non-overlapping</em>) – </p></li>
<li><p><strong>scale</strong> (<em>str</em>) – Data scaling method. Must be one of ‘standard’ (default; recommended) and ‘minmax’.</p></li>
<li><p><strong>test_videos</strong> (<em>int</em>) – Number of videos to use for testing. If 0, no test set is generated.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – Verbosity level. 0 (default) is silent, 1 prints progress, 2 prints debug information.</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em>) – Whether to shuffle the data before preprocessing. Defaults to False.</p></li>
<li><p><strong>filter_low_variance</strong> (<em>float</em>) – remove features with variance lower than the specified threshold. Useful to</p></li>
<li><p><strong>alignment</strong> (<em>get rid</em><em> of </em><em>the x axis</em><em> of </em><em>the body part used for</em>) – </p></li>
<li><p><strong>interpolate_normalized</strong> (<em>int</em>) – if not 0, it specifies the number of standard deviations beyond which values will be</p></li>
<li><p><strong>&quot;standard&quot;.</strong> (<em>interpolated after normalization. Only used if scale is set to</em>) – </p></li>
<li><p><strong>precomputed_breaks</strong> (<em>dict</em>) – If provided, changepoint detection is prevented, and provided breaks are used instead.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3D dataset with shape (instances, sliding_window_size, features)
generated from all training videos.
y_train (np.ndarray): 3D dataset with shape (instances, sliding_window_size, labels)
generated from all training videos. Note that no labels are use by default in the fully
unsupervised pipeline (in which case this is an empty array).
X_test (np.ndarray): 3D dataset with shape (instances, sliding_window_size, features)
generated from all test videos (0 by default).
y_test (np.ndarray): 3D dataset with shape (instances, sliding_window_size, labels)
generated from all test videos. Note that no labels are use by default in the fully
unsupervised pipeline (in which case this is an empty array).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>X_train (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="deepof-deepof-train-embeddings-module">
<h2>deepof.deepof_train_embeddings module<a class="headerlink" href="#deepof-deepof-train-embeddings-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-deepof.hypermodels">
<span id="deepof-hypermodels-module"></span><h2>deepof.hypermodels module<a class="headerlink" href="#module-deepof.hypermodels" title="Permalink to this heading"></a></h2>
<p>keras_tuner hypermodels for hyperparameter tuning of deep autoencoders in deepof.models</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepof.hypermodels.VQVAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.hypermodels.</span></span><span class="sig-name descname"><span class="pre">VQVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.VQVAE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">HyperModel</span></code></p>
<p>Hyperparameter tuning pipeline for deepof.models.SEQ_2_SEQ_VQVAE</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.hypermodels.VQVAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.VQVAE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>VQVAE hypermodel for hyperparameter tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input tensor.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimension of the latent space.</p></li>
<li><p><strong>learn_rate</strong> (<em>float</em>) – learning rate for the optimizer.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – number of components in the quantization space.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.hypermodels.VQVAE.get_hparams">
<span class="sig-name descname"><span class="pre">get_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.VQVAE.get_hparams" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve hyperparameters to tune, including the encoder type and the weight of the kmeans loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.hypermodels.VQVAE.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.VQVAE.build" title="Permalink to this definition"></a></dt>
<dd><p>Overrides Hypermodel’s build method</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.hypermodels.GMVAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.hypermodels.</span></span><span class="sig-name descname"><span class="pre">GMVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.GMVAE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">HyperModel</span></code></p>
<p>Hyperparameter tuning pipeline for deepof.models.SEQ_2_SEQ_GMVAE</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.hypermodels.GMVAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learn_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.GMVAE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>GMVAE hypermodel for hyperparameter tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input tensor.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimension of the latent space.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size for training.</p></li>
<li><p><strong>learn_rate</strong> (<em>float</em>) – learning rate for the optimizer.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – number of components in the quantization space.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.hypermodels.GMVAE.get_hparams">
<span class="sig-name descname"><span class="pre">get_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.GMVAE.get_hparams" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve hyperparameters to tune</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.hypermodels.GMVAE.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.hypermodels.GMVAE.build" title="Permalink to this definition"></a></dt>
<dd><p>Overrides Hypermodel’s build method</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-deepof.models">
<span id="deepof-models-module"></span><h2>deepof.models module<a class="headerlink" href="#module-deepof.models" title="Permalink to this heading"></a></h2>
<p>deep autoencoder models for unsupervised pose detection.
- VQ-VAE: a variational autoencoder with a vector quantization latent-space (<a class="reference external" href="https://arxiv.org/abs/1711.00937">https://arxiv.org/abs/1711.00937</a>).
- GM-VAE: a variational autoencoder with a Gaussian mixture latent-space.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_recurrent_encoder">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_recurrent_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gru_unroll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional_merge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_recurrent_encoder" title="Permalink to this definition"></a></dt>
<dd><p>Returns a deep neural network capable of encoding the motion tracking instances into a vector ready to be fed to
one of the provided structured latent spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimension of the latent space</p></li>
<li><p><strong>gru_unroll</strong> (<em>bool</em>) – whether to unroll the GRU layers. Defaults to False.</p></li>
<li><p><strong>bidirectional_merge</strong> (<em>str</em>) – how to merge the forward and backward GRU layers. Defaults to “concat”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a keras model that can be trained to encode motion tracking instances into a vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_recurrent_decoder">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_recurrent_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gru_unroll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional_merge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'concat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_recurrent_decoder" title="Permalink to this definition"></a></dt>
<dd><p>Returns a deep neural network capable of decoding the structured latent space generated by one of the compatible
classes into a sequence of motion tracking instances, either reconstructing the original
input, or generating new data from given clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimensionality of the latent space</p></li>
<li><p><strong>gru_unroll</strong> (<em>bool</em>) – whether to unroll the GRU layers. Defaults to False.</p></li>
<li><p><strong>bidirectional_merge</strong> (<em>str</em>) – how to merge the forward and backward GRU layers. Defaults to “concat”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a keras model that can be trained to decode the latent space into a series of motion tracking
sequences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_TCN_encoder">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_TCN_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_stacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">2,</span> <span class="pre">4,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'causal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_TCN_encoder" title="Permalink to this definition"></a></dt>
<dd><p>Returns a Temporal Convolutional Network (TCN) encoder that can be used to encode motion tracking instances into a
vector. Each layer contains a residual block with a convolutional layer and a skip connection. See the following
paper for more details: <a class="reference external" href="https://arxiv.org/pdf/1803.01271.pdf">https://arxiv.org/pdf/1803.01271.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> – dimensionality of the latent space</p></li>
<li><p><strong>conv_filters</strong> – number of filters in the TCN layers</p></li>
<li><p><strong>kernel_size</strong> – size of the convolutional kernels</p></li>
<li><p><strong>conv_stacks</strong> – number of TCN layers</p></li>
<li><p><strong>conv_dilations</strong> – list of dilation factors for each TCN layer</p></li>
<li><p><strong>padding</strong> – padding mode for the TCN layers</p></li>
<li><p><strong>use_skip_connections</strong> – whether to use skip connections between TCN layers</p></li>
<li><p><strong>dropout_rate</strong> – dropout rate for the TCN layers</p></li>
<li><p><strong>activation</strong> – activation function for the TCN layers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a keras model that can be trained to encode a sequence of motion tracking instances into a latent
space using temporal convolutional networks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_TCN_decoder">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_TCN_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_stacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_dilations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(8,</span> <span class="pre">4,</span> <span class="pre">2,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'causal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_skip_connections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_TCN_decoder" title="Permalink to this definition"></a></dt>
<dd><p>Returns a Temporal Convolutional Network (TCN) decoder that can be used to decode a latent space into a sequence of
motion tracking instances. Each layer contains a residual block with a convolutional layer and a skip connection. See
the following paper for more details: <a class="reference external" href="https://arxiv.org/pdf/1803.01271.pdf">https://arxiv.org/pdf/1803.01271.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> – dimensionality of the latent space</p></li>
<li><p><strong>conv_filters</strong> – number of filters in the TCN layers</p></li>
<li><p><strong>kernel_size</strong> – size of the convolutional kernels</p></li>
<li><p><strong>conv_stacks</strong> – number of TCN layers</p></li>
<li><p><strong>conv_dilations</strong> – list of dilation factors for each TCN layer</p></li>
<li><p><strong>padding</strong> – padding mode for the TCN layers</p></li>
<li><p><strong>use_skip_connections</strong> – whether to use skip connections between TCN layers</p></li>
<li><p><strong>dropout_rate</strong> – dropout rate for the TCN layers</p></li>
<li><p><strong>activation</strong> – activation function for the TCN layers</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a keras model that can be trained to decode a latent space into a sequence of motion tracking
instances using temporal convolutional networks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>keras.Model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_transformer_encoder">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_transformer_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_transformer_encoder" title="Permalink to this definition"></a></dt>
<dd><p>Transformer encoder. Based on <a class="reference external" href="https://www.tensorflow.org/text/tutorials/transformer">https://www.tensorflow.org/text/tutorials/transformer</a>.
Adapted according to <a class="reference external" href="https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true">https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true</a>
and <a class="reference external" href="https://arxiv.org/abs/1711.03905">https://arxiv.org/abs/1711.03905</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimensionality of the latent space</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – number of transformer layers to include</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – number of heads of the multi-head-attention layers used on the transformer encoder</p></li>
<li><p><strong>dff</strong> (<em>int</em>) – dimensionality of the token embeddings</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – dropout rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_transformer_decoder">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_transformer_decoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_transformer_decoder" title="Permalink to this definition"></a></dt>
<dd><p>Transformer decoder. Based on <a class="reference external" href="https://www.tensorflow.org/text/tutorials/transformer">https://www.tensorflow.org/text/tutorials/transformer</a>.
Adapted according to <a class="reference external" href="https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true">https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true</a>
and <a class="reference external" href="https://arxiv.org/abs/1711.03905">https://arxiv.org/abs/1711.03905</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimensionality of the latent space</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>) – number of transformer layers to include</p></li>
<li><p><strong>num_heads</strong> (<em>int</em>) – number of heads of the multi-head-attention layers used on the transformer encoder</p></li>
<li><p><strong>dff</strong> (<em>int</em>) – dimensionality of the token embeddings</p></li>
<li><p><strong>dropout_rate</strong> (<em>float</em>) – dropout rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.models.VectorQuantizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">VectorQuantizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VectorQuantizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>Vector quantizer layer, which quantizes the input vectors into a fixed number of clusters using L2 norm. Based on
<a class="reference external" href="https://arxiv.org/pdf/1509.03700.pdf">https://arxiv.org/pdf/1509.03700.pdf</a>, and adapted for clustering using <a class="reference external" href="https://arxiv.org/abs/1806.02199">https://arxiv.org/abs/1806.02199</a>.
Implementation based on <a class="reference external" href="https://keras.io/examples/generative/vq_vae/">https://keras.io/examples/generative/vq_vae/</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VectorQuantizer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VectorQuantizer.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the VQ layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em>) – number of embeddings to use</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – dimensionality of the embeddings</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – beta value for the loss function</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – regularization parameter for the Gram matrix</p></li>
<li><p><strong>**kwargs</strong> – additional arguments for the parent class</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VectorQuantizer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VectorQuantizer.call" title="Permalink to this definition"></a></dt>
<dd><p>Computes the VQ layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>tf.Tensor</em>) – input tensor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>x (tf.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VectorQuantizer.get_code_indices">
<span class="sig-name descname"><span class="pre">get_code_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flattened_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_soft_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VectorQuantizer.get_code_indices" title="Permalink to this definition"></a></dt>
<dd><p>Getter for the code indices at any given time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flattened_inputs</strong> (<em>tf.Tensor</em>) – flattened input tensor (encoder output)</p></li>
<li><p><strong>return_soft_counts</strong> (<em>bool</em>) – whether to return soft counts based on the distance to the codes, instead of</p></li>
<li><p><strong>indices</strong> (<em>the code</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>code indices tensor with cluster assignments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>encoding_indices (tf.Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_vqvae">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_vqvae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'recurrent'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_vqvae" title="Permalink to this definition"></a></dt>
<dd><p>Builds a Vector-Quantization variational autoencoder (VQ-VAE) model, adapted to the DeepOF setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input to the encoder.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimension of the latent space.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – number of embeddings in the embedding layer.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – beta parameter of the VQ loss.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – regularization parameter for the Gram matrix.</p></li>
<li><p><strong>encoder_type</strong> (<em>str</em>) – type of encoder to use. Cab be set to “recurrent” (default), “TCN”, or “transformer”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>connected encoder of the VQ-VAE model.
Outputs a vector of shape (latent_dim,).
decoder (tf.keras.Model): connected decoder of the VQ-VAE model.
quantizer (tf.keras.Model): connected embedder layer of the VQ-VAE model.
Outputs cluster indices of shape (batch_size,).
vqvae (tf.keras.Model): complete VQ VAE model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>encoder (tf.keras.Model)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.models.VQVAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">VQVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VQVAE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>VQ-VAE model adapted to the DeepOF setting.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VQVAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'recurrent'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VQVAE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes a VQ-VAE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – Shape of the input to the full model.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimensionality of the latent space.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of embeddings (clusters) in the embedding layer.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – Beta parameter of the VQ loss, as described in the original VQVAE paper.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – Regularization parameter for the Gram matrix.</p></li>
<li><p><strong>encoder_type</strong> (<em>str</em>) – Type of encoder to use. Can be set to “recurrent” (default), “TCN”, or “transformer”.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VQVAE.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VQVAE.call" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.models.VQVAE.metrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#deepof.models.VQVAE.metrics" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s metrics added using <cite>compile()</cite>, <cite>add_metric()</cite> APIs.</p>
<p>Note: Metrics passed to <cite>compile()</cite> are available only after a <cite>keras.Model</cite>
has been trained/evaluated on actual data.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[&#39;loss&#39;, &#39;mae&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_1</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">output_1</span><span class="p">,</span> <span class="n">output_2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">add_metric</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">output_2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">,</span> <span class="s2">&quot;acc&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[&#39;loss&#39;, &#39;out_loss&#39;, &#39;out_1_loss&#39;, &#39;out_mae&#39;, &#39;out_acc&#39;, &#39;out_1_mae&#39;,</span>
<span class="go">&#39;out_1_acc&#39;, &#39;mean&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VQVAE.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VQVAE.train_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a training step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.VQVAE.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.VQVAE.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a test step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.models.GaussianMixtureLatent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">GaussianMixtureLatent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GaussianMixtureLatent" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>Gaussian Mixture probabilistic latent space model. Used to represent the embedding of motion tracking data in a
mixture of Gaussians with a specified number of components, with means, covariances and weights specified by
neural network layers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GaussianMixtureLatent.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_annealing_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_kl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmd_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmd_annealing_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cluster_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GaussianMixtureLatent.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the Gaussian Mixture Latent layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input data</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – number of components in the Gaussian mixture.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimensionality of the latent space.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size for training.</p></li>
<li><p><strong>kl_warmup</strong> (<em>int</em>) – number of epochs to warm up the KL divergence.</p></li>
<li><p><strong>kl_annealing_mode</strong> (<em>str</em>) – mode to use for annealing the KL divergence. Must be one of “linear” and “sigmoid”.</p></li>
<li><p><strong>mc_kl</strong> (<em>int</em>) – number of Monte Carlo samples to use for computing the KL divergence.</p></li>
<li><p><strong>mmd_warmup</strong> (<em>int</em>) – number of epochs to warm up the MMD.</p></li>
<li><p><strong>mmd_annealing_mode</strong> (<em>str</em>) – mode to use for annealing the MMD. Must be one of “linear” and “sigmoid”.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – weight of the Gram matrix regularization loss.</p></li>
<li><p><strong>reg_cluster_variance</strong> (<em>bool</em>) – whether to penalize uneven cluster variances in the latent space.</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments passed to the parent class</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GaussianMixtureLatent.update_prior">
<span class="sig-name descname"><span class="pre">update_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GaussianMixtureLatent.update_prior" title="Permalink to this definition"></a></dt>
<dd><p>Updates the prior based on a Gaussian Mixture Model fit to the provided embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>embeddings</strong> (<em>tf.Tensor</em>) – embeddings to use for updating the prior.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GaussianMixtureLatent.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GaussianMixtureLatent.call" title="Permalink to this definition"></a></dt>
<dd><p>Computes the output of the layer.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.models.get_gmvae">
<span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">get_gmvae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_annealing_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_kl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cluster_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'recurrent'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.get_gmvae" title="Permalink to this definition"></a></dt>
<dd><p>Builds a Gaussian mixture variational autoencoder (GMVAE) model, adapted to the DeepOF setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – shape of the input data</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – dimensionality of the latent space.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – number of components in the Gaussian mixture.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size for training.</p></li>
<li><p><strong>kl_warmup</strong> – Number of iterations during which to warm up the KL divergence.</p></li>
<li><p><strong>kl_annealing_mode</strong> (<em>str</em>) – mode to use for annealing the KL divergence. Must be one of “linear” and “sigmoid”.</p></li>
<li><p><strong>mc_kl</strong> (<em>int</em>) – number of Monte Carlo samples to use for computing the KL divergence.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – weight of the Gram matrix loss as described in deepof.unsupervised_utils.compute_kmeans_loss.</p></li>
<li><p><strong>reg_cluster_variance</strong> (<em>bool</em>) – whether to penalize uneven cluster variances in the latent space.</p></li>
<li><p><strong>encoder_type</strong> (<em>str</em>) – type of encoder to use. Can be set to “recurrent” (default), “TCN”, or “transformer”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>connected encoder of the VQ-VAE model.
Outputs a vector of shape (latent_dim,).
decoder (tf.keras.Model): connected decoder of the VQ-VAE model.
grouper (tf.keras.Model): deep clustering branch of the VQ-VAE model. Outputs a vector of shape (n_components,).
for each training instance, corresponding to the soft counts for each cluster.
gmvae (tf.keras.Model): complete GMVAE model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>encoder (tf.keras.Model)</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.models.GMVAE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">GMVAE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GMVAE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>Gaussian Mixture Variational Autoencoder for pose motif elucidation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GMVAE.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_annealing_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_warmup_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">montecarlo_kl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cat_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cluster_variance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'recurrent'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GMVAE.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initalizes a GMVAE model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – Shape of the input to the full model.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimensionality of the latent space.</p></li>
<li><p><strong>kl_annealing_mode</strong> (<em>str</em>) – Annealing mode for KL annealing. Can be one of ‘linear’ and ‘sigmoid’.</p></li>
<li><p><strong>kl_warmup_epochs</strong> (<em>int</em>) – Number of epochs to warmup KL annealing.</p></li>
<li><p><strong>montecarlo_kl</strong> (<em>int</em>) – Number of Monte Carlo samples for KL divergence.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of mixture components in the latent space.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – weight of the gram matrix regularization loss.</p></li>
<li><p><strong>reg_cat_clusters</strong> (<em>bool</em>) – whether to use the penalize uneven cluster membership in the latent space, by</p></li>
<li><p><strong>distribution.</strong> (<em>minimizing the KL divergence between cluster membership and a uniform categorical</em>) – </p></li>
<li><p><strong>reg_cluster_variance</strong> (<em>bool</em>) – whether to penalize uneven cluster variances in the latent space.</p></li>
<li><p><strong>encoder_type</strong> (<em>str</em>) – type of encoder to use. Cab be set to “recurrent” (default), “TCN”, or “transformer”.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.models.GMVAE.metrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#deepof.models.GMVAE.metrics" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s metrics added using <cite>compile()</cite>, <cite>add_metric()</cite> APIs.</p>
<p>Note: Metrics passed to <cite>compile()</cite> are available only after a <cite>keras.Model</cite>
has been trained/evaluated on actual data.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[&#39;loss&#39;, &#39;mae&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_1</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">output_1</span><span class="p">,</span> <span class="n">output_2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">add_metric</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">output_2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">,</span> <span class="s2">&quot;acc&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[&#39;loss&#39;, &#39;out_loss&#39;, &#39;out_1_loss&#39;, &#39;out_mae&#39;, &#39;out_acc&#39;, &#39;out_1_mae&#39;,</span>
<span class="go">&#39;out_1_acc&#39;, &#39;mean&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.models.GMVAE.prior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior</span></span><a class="headerlink" href="#deepof.models.GMVAE.prior" title="Permalink to this definition"></a></dt>
<dd><p>Property to retrieve the current model prior</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GMVAE.update_prior">
<span class="sig-name descname"><span class="pre">update_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GMVAE.update_prior" title="Permalink to this definition"></a></dt>
<dd><p>Updates the current prior by fitting a Gaussian Mixture Model to the current embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GMVAE.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GMVAE.call" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GMVAE.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GMVAE.train_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a training step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.GMVAE.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.GMVAE.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a test step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.models.Contrastive">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.models.</span></span><span class="sig-name descname"><span class="pre">Contrastive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.Contrastive" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></p>
<p>Gaussian Mixture Variational Autoencoder for pose motif elucidation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.Contrastive.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'recurrent'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.Contrastive.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initalizes a self-supervised Contrastive embedding model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_shape</strong> (<em>tuple</em>) – Shape of the input to the full model.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Dimensionality of the latent space.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of mixture components in the latent space.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – weight of the gram matrix regularization loss.</p></li>
<li><p><strong>encoder_type</strong> (<em>str</em>) – type of encoder to use. Cab be set to “recurrent” (default), “TCN”, or “transformer”.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepof.models.Contrastive.metrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#deepof.models.Contrastive.metrics" title="Permalink to this definition"></a></dt>
<dd><p>Returns the model’s metrics added using <cite>compile()</cite>, <cite>add_metric()</cite> APIs.</p>
<p>Note: Metrics passed to <cite>compile()</cite> are available only after a <cite>keras.Model</cite>
has been trained/evaluated on actual data.</p>
<p>Examples:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[&#39;loss&#39;, &#39;mae&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_1</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_2</span> <span class="o">=</span> <span class="n">d</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">output_1</span><span class="p">,</span> <span class="n">output_2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">add_metric</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">output_2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">aggregation</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;Adam&quot;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mae&quot;</span><span class="p">,</span> <span class="s2">&quot;acc&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">metrics</span><span class="p">]</span>
<span class="go">[&#39;loss&#39;, &#39;out_loss&#39;, &#39;out_1_loss&#39;, &#39;out_mae&#39;, &#39;out_acc&#39;, &#39;out_1_mae&#39;,</span>
<span class="go">&#39;out_1_acc&#39;, &#39;mean&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.Contrastive.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.Contrastive.call" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.Contrastive.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.Contrastive.train_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a training step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.models.Contrastive.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.models.Contrastive.test_step" title="Permalink to this definition"></a></dt>
<dd><p>Performs a test step.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-deepof.post_hoc">
<span id="deepof-post-hoc-module"></span><h2>deepof.post_hoc module<a class="headerlink" href="#module-deepof.post_hoc" title="Permalink to this heading"></a></h2>
<p>Data structures and functions for analyzing supervised and unsupervised model results.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.get_time_on_cluster">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">get_time_on_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.get_time_on_cluster" title="Permalink to this definition"></a></dt>
<dd><p>Given a set of cluster assignments and the corresponding breaks, computes how much each
animal spent on each cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>soft_counts</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of soft counts, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>each</em>) – </p></li>
<li><p><strong>breaks</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of breaks, where the keys are the names of the experimental</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Whether to normalize the time by the total number of frames in</p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>reduce_dim</strong> (<em>bool</em>) – Whether to reduce the dimensionality of the embeddings to 2D. If False,</p></li>
<li><p><strong>dimensionality.</strong> (<em>the embeddings are kept in their original</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with the time spent on each cluster for each experiment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.get_aggregated_embedding">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">get_aggregated_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.get_aggregated_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Aggregates the embeddings of a set of videos, using the specified aggregation method.
Instead of an embedding per chunk, the function returns an embedding per experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of embeddings, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the embeddings for each</em>) – </p></li>
<li><p><strong>reduce_dim</strong> (<em>bool</em>) – Whether to reduce the dimensionality of the embeddings to 2D. If False,</p></li>
<li><p><strong>dimensionality.</strong> (<em>the embeddings are kept in their original</em>) – </p></li>
<li><p><strong>agg</strong> (<em>str</em>) – The aggregation method to use. Can be either “mean” or “median”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with the aggregated embeddings for each experiment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.select_time_bin">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">select_time_bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.select_time_bin" title="Permalink to this definition"></a></dt>
<dd><p>Selects a time bin and filters all relevant objects (embeddings, soft_counts and breaks).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of embeddings, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the breaks for each</em>) – </p></li>
<li><p><strong>soft_counts</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of soft counts, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>breaks</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of breaks, where the keys are the names of the experimental</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>bin_size</strong> (<em>int</em>) – The size of the time bin to select.</p></li>
<li><p><strong>bin_index</strong> (<em>int</em>) – The index of the time bin to select.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the filtered embeddings, soft counts, and breaks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.condition_distance_binning">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">condition_distance_binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scan_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'growing-window'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.condition_distance_binning" title="Permalink to this definition"></a></dt>
<dd><p>Computes the distance between the embeddings of two conditions, using the specified
aggregation method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of embeddings, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the breaks for each</em>) – </p></li>
<li><p><strong>soft_counts</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of soft counts, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>breaks</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of breaks, where the keys are the names of the experimental</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>exp_conditions</strong> (<em>dict</em>) – A dictionary of experimental conditions, where the keys are the</p></li>
<li><p><strong>experiments</strong> (<em>names</em><em> of </em><em>the</em>) – </p></li>
<li><p><strong>corresponding</strong> (<em>and the values are the names</em><em> of </em><em>their</em>) – </p></li>
<li><p><strong>conditions.</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>start_bin</strong> (<em>int</em>) – The index of the first bin to compute the distance for.</p></li>
<li><p><strong>end_bin</strong> (<em>int</em>) – The index of the last bin to compute the distance for.</p></li>
<li><p><strong>step_bin</strong> (<em>int</em>) – The step size of the bins to compute the distance for.</p></li>
<li><p><strong>scan_mode</strong> (<em>str</em>) – The mode to use for computing the distance. Can be either “growing-window”</p></li>
<li><p><strong>discriminability</strong> (<em>(</em><em>used to select optimal binning</em><em>) or </em><em>&quot;per-bin&quot;</em><em> (</em><em>used to evaluate how</em>) – </p></li>
<li><p><strong>size</strong><strong>)</strong><strong>.</strong> (<em>evolves in subsequent bins</em><em> of </em><em>a specified</em>) – </p></li>
<li><p><strong>agg</strong> (<em>str</em>) – The aggregation method to use. Can be either “mean”, “median”, or “time_on_cluster”.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The distance metric to use. Can be either “auc” (where the reported ‘distance’</p></li>
<li><p><strong>embeddings</strong><strong>)</strong> (<em>is based on performance</em><em> of </em><em>a classifier when separating aggregated</em>) – </p></li>
<li><p><strong>or</strong> – </p></li>
<li><p><strong>&quot;wasserstein&quot;</strong> (<em>which computes distances based on optimal transport</em>) – </p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – The number of jobs to use for parallel processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array with distances between conditions across the resulting time bins</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.separation_between_conditions">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">separation_between_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur_embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cur_soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cur_breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.separation_between_conditions" title="Permalink to this definition"></a></dt>
<dd><p>Computes the distance between the embeddings of two conditions, using the specified
aggregation method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cur_embedding</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of embeddings, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the breaks for each</em>) – </p></li>
<li><p><strong>cur_soft_counts</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of soft counts, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>cur_breaks</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of breaks, where the keys are the names of the experimental</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>exp_conditions</strong> (<em>dict</em>) – A dictionary of experimental conditions, where the keys are the</p></li>
<li><p><strong>experiments</strong> (<em>names</em><em> of </em><em>the</em>) – </p></li>
<li><p><strong>corresponding</strong> (<em>and the values are the names</em><em> of </em><em>their</em>) – </p></li>
<li><p><strong>conditions.</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>agg</strong> (<em>str</em>) – The aggregation method to use. Can be one of “time on cluster”, “mean”, or “median”.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – The distance metric to use. Can be either “auc” (where the reported ‘distance’</p></li>
<li><p><strong>embeddings</strong><strong>)</strong> (<em>is based on performance</em><em> of </em><em>a classifier when separating aggregated</em>) – </p></li>
<li><p><strong>or</strong> – </p></li>
<li><p><strong>&quot;wasserstein&quot;</strong> (<em>which computes distances based on optimal transport</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The distance between the embeddings of the two conditions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.cluster_enrichment_across_conditions">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">cluster_enrichment_across_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.cluster_enrichment_across_conditions" title="Permalink to this definition"></a></dt>
<dd><p>Computes the population of each cluster across conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of embeddings, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the breaks for each</em>) – </p></li>
<li><p><strong>soft_counts</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of soft counts, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>breaks</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of breaks, where the keys are the names of the experimental</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>exp_conditions</strong> (<em>dict</em>) – A dictionary of experimental conditions, where the keys are the</p></li>
<li><p><strong>experiments</strong> (<em>names</em><em> of </em><em>the</em>) – </p></li>
<li><p><strong>corresponding</strong> (<em>and the values are the names</em><em> of </em><em>their</em>) – </p></li>
<li><p><strong>conditions.</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>bin_size</strong> (<em>int</em>) – The size of the time bins to use. If None, the embeddings are not binned.</p></li>
<li><p><strong>bin_index</strong> (<em>int</em>) – The index of the bin to use. If None, the embeddings are not binned.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em>) – Whether to normalize the population of each cluster across conditions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A long format dataframe with the population of each cluster across conditions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.get_transitions">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">get_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.get_transitions" title="Permalink to this definition"></a></dt>
<dd><p>Computes the transitions between states in a state sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_sequence</strong> (<em>list</em>) – A list of states.</p></li>
<li><p><strong>n_states</strong> (<em>int</em>) – The number of states.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting transition matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.compute_transition_matrix_per_condition">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">compute_transition_matrix_per_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.compute_transition_matrix_per_condition" title="Permalink to this definition"></a></dt>
<dd><p>Computes the transition matrices specific to each condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of embeddings, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> (<em>experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the breaks for each</em>) – </p></li>
<li><p><strong>soft_counts</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of soft counts, where the keys are the names of the</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>breaks</strong> (<a class="reference internal" href="#deepof.data.TableDict" title="deepof.data.TableDict"><em>TableDict</em></a>) – A dictionary of breaks, where the keys are the names of the experimental</p></li>
<li><p><strong>conditions</strong> – </p></li>
<li><p><strong>condition.</strong> – </p></li>
<li><p><strong>exp_conditions</strong> (<em>dict</em>) – A dictionary of experimental conditions, where the keys are the</p></li>
<li><p><strong>experiments</strong> (<em>names</em><em> of </em><em>the</em>) – </p></li>
<li><p><strong>corresponding</strong> (<em>and the values are the names</em><em> of </em><em>their</em>) – </p></li>
<li><p><strong>bin_size</strong> (<em>int</em>) – The size of the time bins to use. If None, the embeddings are not binned.</p></li>
<li><p><strong>bin_index</strong> (<em>int</em>) – The index of the bin to use. If None, the embeddings are not binned.</p></li>
<li><p><strong>aggregate</strong> (<em>str</em>) – Whether to aggregate the embeddings across time.</p></li>
<li><p><strong>normalize</strong> (<em>str</em>) – Whether to normalize the population of each cluster across conditions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of transition matrices, where the keys are the names of the experimental
conditions, and the values are the transition matrices for each condition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.compute_steady_state">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">compute_steady_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transition_matrices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_entropy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.compute_steady_state" title="Permalink to this definition"></a></dt>
<dd><p>Computes the steady state of each transition matrix provided in a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transition_matrices</strong> (<em>dict</em>) – A dictionary of transition matrices, where the keys are</p></li>
<li><p><strong>conditions</strong> (<em>the names</em><em> of </em><em>the experimental</em>) – </p></li>
<li><p><strong>condition.</strong> (<em>and the values are the transition matrices for each</em>) – </p></li>
<li><p><strong>return_entropy</strong> (<em>bool</em>) – Whether to return the entropy of the steady state. If False, the steady states themselves are</p></li>
<li><p><strong>returned.</strong> – </p></li>
<li><p><strong>n_iters</strong> (<em>int</em>) – The number of iterations to use for the Markov chain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of steady states, where the keys are the names of the experimental conditions, and the values are
the steady states for each condition. If return_entropy is True, values correspond to the entropy of each
steady state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.align_deepof_kinematics_with_unsupervised_labels">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">align_deepof_kinematics_with_unsupervised_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepof_project</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_project</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kin_derivative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_areas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.align_deepof_kinematics_with_unsupervised_labels" title="Permalink to this definition"></a></dt>
<dd><p>In order to annotate time chunks with as many relevant features as possible, this function aligns the kinematics
of a deepof project (speed and acceleration of body parts, distances, and angles) with the hard cluster assignments
obtained from the unsupervised pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deepof_project</strong> (<a class="reference internal" href="#deepof.data.Project" title="deepof.data.Project"><em>Project</em></a>) – A deepof.Project object.</p></li>
<li><p><strong>kin_derivative</strong> (<em>int</em>) – The order of the derivative to use for the kinematics. 1 = speed, 2 = acceleration, etc.</p></li>
<li><p><strong>include_distances</strong> (<em>bool</em>) – Whether to include distances in the alignment. kin_derivative is taken into account.</p></li>
<li><p><strong>include_angles</strong> (<em>bool</em>) – Whether to include angles in the alignment. kin_derivative is taken into account.</p></li>
<li><p><strong>include_areas</strong> (<em>bool</em>) – Whether to include areas in the alignment. kin_derivative is taken into account.</p></li>
<li><p><strong>animal_id</strong> (<em>str</em>) – The animal ID to use, in case of multi-animal projects.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary of aligned kinematics, where the keys are the names of the experimental conditions, and the
values are the aligned kinematics for each condition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.chunk_summary_statistics">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">chunk_summary_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunked_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body_part_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.chunk_summary_statistics" title="Permalink to this definition"></a></dt>
<dd><p>Extracts summary statistics from a chunked dataset using seglearn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunked_dataset</strong> (<em>np.ndarray</em>) – Preprocessed training set (of shape chunks x time x features),</p></li>
<li><p><strong>data.</strong> (<em>where each entry corresponds to a time chunk of</em>) – </p></li>
<li><p><strong>body_part_names</strong> (<em>list</em>) – A list of the names of the body parts.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe of kinematic features, of shape chunks by features.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.annotate_time_chunks">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">annotate_time_chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deepof_project</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_project</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supervised_annotations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">deepof_table_dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kin_derivative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_areas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'seglearn'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.annotate_time_chunks" title="Permalink to this definition"></a></dt>
<dd><p>Annotate time chunks produced after change-point detection using the unsupervised pipeline, using a set
of summary statistics coming from kinematics, distances, angles, and supervised labels when provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deepof_project</strong> – deepof.data.Project object.</p></li>
<li><p><strong>soft_counts</strong> – matrix with soft cluster assignments produced by the unsupervised pipeline.</p></li>
<li><p><strong>breaks</strong> – the breaks for each condition.</p></li>
<li><p><strong>supervised_annotations</strong> – set of supervised annotations produced by the supervised pipeline withing deepof.</p></li>
<li><p><strong>animal_id</strong> – The animal ID to use, in case of multi-animal projects.</p></li>
<li><p><strong>kin_derivative</strong> – The order of the derivative to use for the kinematics. 1 = speed, 2 = acceleration, etc.</p></li>
<li><p><strong>include_distances</strong> – Whether to include distances in the alignment. kin_derivative is taken into account.</p></li>
<li><p><strong>include_angles</strong> – Whether to include angles in the alignment. kin_derivative is taken into account.</p></li>
<li><p><strong>include_areas</strong> – Whether to include areas in the alignment. kin_derivative is taken into account.</p></li>
<li><p><strong>aggregate</strong> – aggregation mode. Can be either “mean” (computationally cheapest), just use the average per feature,</p></li>
<li><p><strong>series.</strong> (<em>or &quot;seglearn&quot; which runs a thorough feature extraction and selection pipeline on each time</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe of kinematic features, of shape chunks by features.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.post_hoc.chunk_cv_splitter">
<span class="sig-prename descclassname"><span class="pre">deepof.post_hoc.</span></span><span class="sig-name descname"><span class="pre">chunk_cv_splitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_folds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qual_filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.post_hoc.chunk_cv_splitter" title="Permalink to this definition"></a></dt>
<dd><p>Given a matrix with extracted features per chunk, returns a list containing
a set of cross-validation folds, grouped by experimental video. This makes
sure that chunks coming from the same experiment will never be leaked between
training and testing sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunk_stats</strong> – matrix with statistics per chunk, sorted by experiment</p></li>
<li><p><strong>breaks</strong> – dictionary containing ruprures per video</p></li>
<li><p><strong>n_folds</strong> – number of cross-validation folds to compute</p></li>
<li><p><strong>qual_filter</strong> – quality filter to use for the cross-validation. If None, no filter is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list containing a training and testing set per CV fold.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepof.supervised_utils">
<span id="deepof-supervised-utils-module"></span><h2>deepof.supervised_utils module<a class="headerlink" href="#module-deepof.supervised_utils" title="Permalink to this heading"></a></h2>
<p>Functions and general utilities for supervised pose estimation. See documentation for details</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.close_single_contact">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">close_single_contact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_rel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.supervised_utils.close_single_contact" title="Permalink to this definition"></a></dt>
<dd><p>Returns a boolean array that’s True if the specified body parts are closer than tol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_dframe</strong> (<em>-</em>) – DLC output as pandas.DataFrame; only applicable</p></li>
<li><p><strong>experiments.</strong> (<em>to two-animal</em>) – </p></li>
<li><p><strong>left</strong> (<em>-</em>) – First member of the potential contact</p></li>
<li><p><strong>right</strong> (<em>-</em>) – Second member of the potential contact</p></li>
<li><p><strong>tol</strong> (<em>-</em>) – maximum distance for which a contact is reported</p></li>
<li><p><strong>arena_abs</strong> (<em>-</em>) – length in mm of the diameter of the real arena</p></li>
<li><p><strong>arena_rel</strong> (<em>-</em>) – length in pixels of the diameter of the arena in the video</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the distance between the two specified points
is less than tol, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>contact_array (np.array)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.close_double_contact">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">close_double_contact</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_rel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rev</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.supervised_utils.close_double_contact" title="Permalink to this definition"></a></dt>
<dd><p>Returns a boolean array that’s True if the specified body parts are closer than tol.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_dframe</strong> (<em>-</em>) – DLC output as pandas.DataFrame; only applicable</p></li>
<li><p><strong>experiments.</strong> (<em>to two-animal</em>) – </p></li>
<li><p><strong>left1</strong> (<em>-</em>) – First contact point of animal 1</p></li>
<li><p><strong>left2</strong> (<em>-</em>) – Second contact point of animal 1</p></li>
<li><p><strong>right1</strong> (<em>-</em>) – First contact point of animal 2</p></li>
<li><p><strong>right2</strong> (<em>-</em>) – Second contact point of animal 2</p></li>
<li><p><strong>tol</strong> (<em>-</em>) – maximum distance for which a contact is reported</p></li>
<li><p><strong>arena_abs</strong> (<em>-</em>) – length in mm of the diameter of the real arena</p></li>
<li><p><strong>arena_rel</strong> (<em>-</em>) – length in pixels of the diameter of the arena in the video</p></li>
<li><p><strong>rev</strong> (<em>-</em>) – reverses the default behaviour (nose2tail contact for both mice)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the distance between the two specified points
is less than tol, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>double_contact (np.array)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.rotate">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">origin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.rotate" title="Permalink to this definition"></a></dt>
<dd><p>Auxiliar function to climb_wall and sniff_object. Rotates x,y coordinates over a pivot</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.outside_ellipse">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">outside_ellipse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.outside_ellipse" title="Permalink to this definition"></a></dt>
<dd><p>Auxiliar function to climb_wall and sniff_object. Returns True if the passed x, y coordinates
are outside the ellipse denoted by e_center, e_axes and e_angle, with a certain threshold</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.climb_wall">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">climb_wall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arena_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.supervised_utils.climb_wall" title="Permalink to this definition"></a></dt>
<dd><p>Returns True if the specified mouse is climbing the wall</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arena_type</strong> (<em>-</em>) – arena type; must be one of [‘polygonal-manual’, ‘circular-autodetect’]</p></li>
<li><p><strong>arena</strong> (<em>-</em>) – contains arena location and shape details</p></li>
<li><p><strong>pos_dict</strong> (<em>-</em>) – position over time for all videos in a project</p></li>
<li><p><strong>tol</strong> (<em>-</em>) – minimum tolerance to report a hit</p></li>
<li><p><strong>nose</strong> (<em>-</em>) – indicates the name of the body part representing the nose of</p></li>
<li><p><strong>animal</strong> (<em>the selected</em>) – </p></li>
<li><p><strong>arena_dims</strong> (<em>-</em>) – indicates radius of the real arena in mm</p></li>
<li><p><strong>centered_data</strong> (<em>-</em>) – indicates whether the input data is centered</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean array. True if selected animal
is climbing the walls of the arena</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>climbing (np.array)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.sniff_object">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">sniff_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">speed_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'arena'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.sniff_object" title="Permalink to this definition"></a></dt>
<dd><p>Returns True if the specified mouse is sniffing an object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>speed_dframe</strong> (<em>-</em>) – speed of body parts over time</p></li>
<li><p><strong>arena_type</strong> (<em>-</em>) – arena type; must be one of [‘polygonal-manual’, ‘circular-autodetect’]</p></li>
<li><p><strong>arena</strong> (<em>-</em>) – contains arena location and shape details</p></li>
<li><p><strong>pos_dict</strong> (<em>-</em>) – position over time for all videos in a project</p></li>
<li><p><strong>tol</strong> (<em>-</em>) – minimum tolerance to report a hit</p></li>
<li><p><strong>nose</strong> (<em>-</em>) – indicates the name of the body part representing the nose of</p></li>
<li><p><strong>animal</strong> (<em>the selected</em>) – </p></li>
<li><p><strong>arena_dims</strong> (<em>-</em>) – indicates radius of the real arena in mm</p></li>
<li><p><strong>centered_data</strong> (<em>-</em>) – indicates whether the input data is centered</p></li>
<li><p><strong>object</strong> (<em>-</em>) – indicates the object that the animal is sniffing.</p></li>
<li><p><strong>[</strong><strong>'arena'</strong> (<em>Can be one of</em>) – </p></li>
<li><p><strong>'partner'</strong><strong>]</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>boolean array. True if selected animal
is sniffing the selected object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>sniffing (np.array)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.huddle">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">huddle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">huddle_estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.supervised_utils.huddle" title="Permalink to this definition"></a></dt>
<dd><p>Returns true when the mouse is huddling a pretrained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_dframe</strong> (<em>-</em>) – position of body parts over time</p></li>
<li><p><strong>speed_dframe</strong> (<em>-</em>) – speed of body parts over time</p></li>
<li><p><strong>huddle_estimator</strong> (<em>-</em>) – pre-trained model to predict feature occurrence</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if the animal is huddling, 0 otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y_huddle (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.dig">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">dig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speed_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dig_estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.dig" title="Permalink to this definition"></a></dt>
<dd><p>Returns true when the mouse is digging using a pretrained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_dframe</strong> (<em>-</em>) – position of body parts over time</p></li>
<li><p><strong>speed_dframe</strong> (<em>-</em>) – speed of body parts over time</p></li>
<li><p><strong>dig_estimator</strong> (<em>-</em>) – pre-trained model to predict feature occurrence</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the animal is digging, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dig (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.look_around">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">look_around</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">speed_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_speed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.look_around" title="Permalink to this definition"></a></dt>
<dd><p>Returns true when the mouse is looking around using simple rules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>speed_dframe</strong> (<em>-</em>) – speed of body parts over time</p></li>
<li><p><strong>likelihood_dframe</strong> (<em>-</em>) – likelihood of body part tracker over time,</p></li>
<li><p><strong>DeepLabCut</strong> (<em>as directly obtained from</em>) – </p></li>
<li><p><strong>tol_speed</strong> (<em>-</em>) – Maximum tolerated speed for the center of the mouse</p></li>
<li><p><strong>tol_likelihood</strong> (<em>-</em>) – Maximum tolerated likelihood for the nose (if the animal</p></li>
<li><p><strong>digging</strong> (<em>is</em>) – </p></li>
<li><p><strong>occluded</strong><strong>)</strong><strong>.</strong> (<em>the nose is momentarily</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the animal is standing still and looking around, False otherwise</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>lookaround (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.following_path">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">following_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distance_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">follower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">followed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.supervised_utils.following_path" title="Permalink to this definition"></a></dt>
<dd><p>For multi animal videos only. Returns True if ‘follower’ is closer than tol to the path that
followed has walked over the last specified number of frames</p>
<blockquote>
<div><dl class="simple">
<dt>Parameters:</dt><dd><ul class="simple">
<li><p>distance_dframe (pandas.DataFrame): distances between bodyparts; generated by the preprocess module</p></li>
<li><p>position_dframe (pandas.DataFrame): position of bodyparts; generated by the preprocess module</p></li>
<li><p>follower (str) identifier for the animal who’s following</p></li>
<li><p>followed (str) identifier for the animal who’s followed</p></li>
<li><p>frames (int) frames in which to track whether the process consistently occurs,</p></li>
<li><p>tol (float) Maximum distance for which True is returned</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>follow (np.array): boolean sequence, True if conditions are fulfilled, False otherwise</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.max_behaviour">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">max_behaviour</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behaviour_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.supervised_utils.max_behaviour" title="Permalink to this definition"></a></dt>
<dd><p>Returns the most frequent behaviour in a window of window_size frames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>behaviour_dframe</strong> (<em>-</em>) – boolean matrix containing occurrence</p></li>
<li><p><strong>video</strong> (<em>of tagged behaviours per frame in the</em>) – </p></li>
<li><p><strong>window_size</strong> (<em>-</em>) – size of the window to use when computing</p></li>
<li><p><strong>slot</strong> (<em>the maximum behaviour per time</em>) – </p></li>
<li><p><strong>stepped</strong> (<em>-</em>) – sliding windows don’t overlap if True. False by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>string array with the most common behaviour per instance
of the sliding window</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>max_array (np.array)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.get_hparameters">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">get_hparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#deepof.supervised_utils.get_hparameters" title="Permalink to this definition"></a></dt>
<dd><p>Returns the most frequent behaviour in a window of window_size frames</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hparams</strong> (<em>-</em>) – dictionary containing hyperparameters to overwrite</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary with overwritten parameters. Those not
specified in the input retain their default values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>defaults (dict)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.frame_corners">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">frame_corners</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.frame_corners" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary with the corner positions of the video frame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<em>-</em>) – width of the frame in pixels</p></li>
<li><p><strong>h</strong> (<em>-</em>) – height of the frame in pixels</p></li>
<li><p><strong>corners</strong> (<em>-</em>) – dictionary containing corners to overwrite</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary with overwriten parameters. Those not
specified in the input retain their default values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>defaults (dict)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.supervised_tagging">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">supervised_tagging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dists</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">speeds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trained_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.supervised_utils.supervised_tagging" title="Permalink to this definition"></a></dt>
<dd><p>Outputs a dataframe with the registered motives per frame. If specified, produces a labeled
video displaying the information in real time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord_object</strong> (<em>-</em>) – coordinates object containing the project information</p></li>
<li><p><strong>raw_coords</strong> (<em>-</em>) – table_dict with raw coordinates</p></li>
<li><p><strong>coords</strong> (<em>-</em>) – table_dict with already processed (centered and aligned) coordinates</p></li>
<li><p><strong>dists</strong> (<em>-</em>) – table_dict with already processed distances</p></li>
<li><p><strong>angs</strong> (<em>-</em>) – table_dict with already processed angles</p></li>
<li><p><strong>speeds</strong> (<em>-</em>) – table_dict with already processed speeds</p></li>
<li><p><strong>video</strong> (<em>-</em>) – string name of the experiment to tag</p></li>
<li><p><strong>trained_model_path</strong> (<em>-</em>) – path indicating where all pretrained models are located</p></li>
<li><p><strong>params</strong> (<em>-</em>) – dictionary to overwrite the default values of the parameters of the functions</p></li>
<li><p><strong>details.</strong> (<em>that the rule-based pose estimation utilizes. See documentation for</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>table with traits as columns and frames as rows. Each
value is a boolean indicating trait detection at a given time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>tag_df (pandas.DataFrame)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.tag_annotated_frames">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">tag_annotated_frames</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_speeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corners</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">undercond</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.supervised_utils.tag_annotated_frames" title="Permalink to this definition"></a></dt>
<dd><p>Helper function for annotate_video. Annotates a given frame with on-screen information
about the recognised patterns</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.supervised_utils.annotate_video">
<span class="sig-prename descclassname"><span class="pre">deepof.supervised_utils.</span></span><span class="sig-name descname"><span class="pre">annotate_video</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_coordinates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vid_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="k"><span class="pre">True</span></span></span></span><a class="headerlink" href="#deepof.supervised_utils.annotate_video" title="Permalink to this definition"></a></dt>
<dd><p>Renders a version of the input video with all supervised taggings in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coordinates</strong> (<em>-</em>) – coordinates object containing the project information</p></li>
<li><p><strong>debug</strong> (<em>-</em>) – if True, several debugging attributes (such as used body parts and arena) are plotted in</p></li>
<li><p><strong>video</strong> (<em>the output</em>) – </p></li>
<li><p><strong>vid_index</strong> (<em>-</em>) – for internal usage only; index of the video to tag in coordinates._videos</p></li>
<li><p><strong>frame_limit</strong> (<em>-</em>) – limit the number of frames to output. Generates all annotated frames by default</p></li>
<li><p><strong>params</strong> (<em>-</em>) – dictionary to overwrite the default values of the hyperparameters of the functions</p></li>
<li><p><strong>be</strong> (<em>that the supervised pose estimation utilizes. Values can</em>) – <ul>
<li><p>speed_pause (int): size of the rolling window to use when computing speeds</p></li>
<li><p>close_contact_tol (int): maximum distance between single bodyparts that can be used to report the trait</p></li>
<li><p>side_contact_tol (int): maximum distance between single bodyparts that can be used to report the trait</p></li>
<li><p>follow_frames (int): number of frames during which the following trait is tracked</p></li>
<li><p>follow_tol (int): maximum distance between follower and followed’s path during the last follow_frames,</p></li>
</ul>
<p>in order to report a detection
- huddle_forward (int): maximum distance between ears and forward limbs to report a huddle detection
- huddle_speed (int): maximum speed to report a huddle detection
- fps (float): frames per second of the analysed video. Same as input by default</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepof.unsupervised_utils">
<span id="deepof-unsupervised-utils-module"></span><h2>deepof.unsupervised_utils module<a class="headerlink" href="#module-deepof.unsupervised_utils" title="Permalink to this heading"></a></h2>
<p>Utility functions for both training autoencoder models in deepof.models and tuning hyperparameters with deepof.hypermodels.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.select_contrastive_loss">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">select_contrastive_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nce'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.select_contrastive_loss" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> – </p></li>
<li><p><strong>future</strong> – </p></li>
<li><p><strong>similarity</strong> – </p></li>
<li><p><strong>loss_fn</strong> – </p></li>
<li><p><strong>temperature</strong> – </p></li>
<li><p><strong>tau</strong> – </p></li>
<li><p><strong>beta</strong> – </p></li>
<li><p><strong>elimination_topk</strong> – </p></li>
<li><p><strong>attraction</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.nce_loss_fn">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">nce_loss_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.nce_loss_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.dcl_loss_fn">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">dcl_loss_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debiased</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_plus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.dcl_loss_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.fc_loss_fn">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">fc_loss_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_topk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.fc_loss_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.hard_loss_fn">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">hard_loss_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debiased</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau_plus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.hard_loss_fn" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.load_treatments">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">load_treatments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.load_treatments" title="Permalink to this definition"></a></dt>
<dd><p>Loads a dictionary containing the treatments per individual, to be loaded as metadata in the coordinates class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>train_path</strong> (<em>str</em>) – path to the training data.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing the treatments per individual.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.compute_kmeans_loss">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">compute_kmeans_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latent_means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.compute_kmeans_loss" title="Permalink to this definition"></a></dt>
<dd><p>Adds a penalty to the singular values of the Gram matrix of the latent means. It helps disentangle the latent
space.
Based on <a class="reference external" href="https://arxiv.org/pdf/1610.04794.pdf">https://arxiv.org/pdf/1610.04794.pdf</a>, and <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.14.095430v3">https://www.biorxiv.org/content/10.1101/2020.05.14.095430v3</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latent_means</strong> – tensor containing the means of the latent distribution</p></li>
<li><p><strong>weight</strong> – weight of the Gram loss in the total loss function</p></li>
<li><p><strong>batch_size</strong> – batch size of the data to compute the kmeans loss for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>kmeans loss</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.get_k_nearest_neighbors">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">get_k_nearest_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.get_k_nearest_neighbors" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve indices of the k nearest neighbors in tensor to the vector with the specified index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>tf.Tensor</em>) – tensor to compute the k nearest neighbors for</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of nearest neighbors to retrieve</p></li>
<li><p><strong>index</strong> (<em>int</em>) – index of the vector to compute the k nearest neighbors for</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>indices of the k nearest neighbors</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.compute_shannon_entropy">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">compute_shannon_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.compute_shannon_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Computes Shannon entropy for a given tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>tf.Tensor</em>) – tensor to compute the entropy for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>entropy of the tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.get_neighbourhood_entropy">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">get_neighbourhood_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.get_neighbourhood_entropy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the neighbourhood entropy for a given vector in a tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>) – index of the vector to compute the neighbourhood entropy for</p></li>
<li><p><strong>tensor</strong> (<em>tf.Tensor</em>) – tensor to compute the neighbourhood entropy for</p></li>
<li><p><strong>clusters</strong> (<em>tf.Tensor</em>) – tensor containing the cluster labels for each vector in the tensor</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of nearest neighbours to consider</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>neighbourhood entropy of the vector with the specified index</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.plot_lr_vs_loss">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">plot_lr_vs_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.plot_lr_vs_loss" title="Permalink to this definition"></a></dt>
<dd><p>Plots learing rate versus the loss function of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rates</strong> (<em>np.ndarray</em>) – array containing the learning rates to plot in the x-axis</p></li>
<li><p><strong>losses</strong> (<em>np.ndarray</em>) – array containing the losses to plot in the y-axis</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.get_angles">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">get_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.get_angles" title="Permalink to this definition"></a></dt>
<dd><p>Auxiliary function for positional encoding computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>int</em>) – position in the sequence.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – number of sequences.</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – dimensionality of the embeddings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.positional_encoding">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">positional_encoding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.positional_encoding" title="Permalink to this definition"></a></dt>
<dd><p>Computes positional encodings, as in
<a class="reference external" href="https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf">https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<em>int</em>) – position in the sequence.</p></li>
<li><p><strong>d_model</strong> (<em>int</em>) – dimensionality of the embeddings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.create_padding_mask">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">create_padding_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.create_padding_mask" title="Permalink to this definition"></a></dt>
<dd><p>Creates a padding mask, with zeros where data is missing, and ones where data is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seq</strong> (<em>tf.Tensor</em>) – Sequence to compute the mask on</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.create_look_ahead_mask">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">create_look_ahead_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.create_look_ahead_mask" title="Permalink to this definition"></a></dt>
<dd><p>Creates a triangular matrix containing an increasing amount of ones from left to right on each subsequent row.
Useful for transformer decoder, which allows it to go through the data in a sequential manner, without taking
the future into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>size</strong> (<em>int</em>) – number of time steps in the sequence</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.create_masks">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">create_masks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.create_masks" title="Permalink to this definition"></a></dt>
<dd><p>Given an input sequence, it creates all necessary masks to pass it through the transformer architecture.
This includes encoder and decoder padding masks, and a look-ahead mask</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inp</strong> (<em>tf.Tensor</em>) – input sequence to create the masks for.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.find_learning_rate">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">find_learning_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.find_learning_rate" title="Permalink to this definition"></a></dt>
<dd><p>Trains the provided model for an epoch with an exponentially increasing learning rate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.Model</em>) – model to train</p></li>
<li><p><strong>data</strong> (<em>tuple</em>) – training data</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – number of epochs to train the model for</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size to use for training</p></li>
<li><p><strong>min_rate</strong> (<em>float</em>) – minimum learning rate to consider</p></li>
<li><p><strong>max_rate</strong> (<em>float</em>) – maximum learning rate to consider</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>learning rate that resulted in the lowest loss</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.get_hard_counts">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">get_hard_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.get_hard_counts" title="Permalink to this definition"></a></dt>
<dd><p>Computes hard counts per cluster in a differentiable way</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>soft_counts</strong> (<em>tf.Tensor</em>) – soft counts per cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.cluster_frequencies_regularizer">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">cluster_frequencies_regularizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">soft_counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.cluster_frequencies_regularizer" title="Permalink to this definition"></a></dt>
<dd><p>Computes the KL divergence between the cluster assignment distribution
and a uniform prior across clusters. While this assumes an equal distribution
between clusters, the prior can be tweaked to reflect domain knowledge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>soft_counts</strong> (<em>tf.Tensor</em>) – soft counts per cluster</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of clusters</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – number of samples to draw from the categorical distribution</p></li>
<li><p><strong>assignments.</strong> (<em>modeling cluster</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.get_callbacks">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">get_callbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.unsupervised_utils.get_callbacks" title="Permalink to this definition"></a></dt>
<dd><p>Generates callbacks used for model training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>embedding_model</strong> (<em>str</em>) – name of the embedding model</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – Weight of the gram loss</p></li>
<li><p><strong>input_type</strong> (<em>str</em>) – Input type to use for training</p></li>
<li><p><strong>cp</strong> (<em>bool</em>) – Whether to use checkpointing or not</p></li>
<li><p><strong>logparam</strong> (<em>dict</em>) – Dictionary containing the hyperparameters to log in tensorboard</p></li>
<li><p><strong>outpath</strong> (<em>str</em>) – Path to the output directory</p></li>
<li><p><strong>run</strong> (<em>int</em>) – Run number to use for checkpointing</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of callbacks to be used for training</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Union[Any]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.CustomStopper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">CustomStopper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_epoch</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.CustomStopper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">EarlyStopping</span></code></p>
<p>Custom early stopping callback. Prevents the model from stopping before warmup is over.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.CustomStopper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_epoch</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.CustomStopper.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the CustomStopper callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_epoch</strong> – epoch from which performance will be taken into account when deciding whether to stop training.</p></li>
<li><p><strong>*args</strong> – arguments passed to the callback.</p></li>
<li><p><strong>**kwargs</strong> – keyword arguments passed to the callback.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.CustomStopper.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.CustomStopper.get_config" title="Permalink to this definition"></a></dt>
<dd><p>Updates callback metadata</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.CustomStopper.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.CustomStopper.on_epoch_end" title="Permalink to this definition"></a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should only
be called during TRAIN mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> – Integer, index of epoch.</p></li>
<li><p><strong>logs</strong> – <dl>
<dt>Dict, metric results for this training epoch, and for the</dt><dd><p>validation epoch if validation is performed. Validation result keys
are prefixed with <cite>val_</cite>. For training epoch, the values of the</p>
</dd>
<dt><cite>Model</cite>’s metrics are returned. Example<span class="classifier"><a href="#id1"><span class="problematic" id="id2">`</span></a>{‘loss’: 0.2, ‘accuracy’:</span></dt><dd><p>0.7}`.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ExponentialLearningRate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">ExponentialLearningRate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ExponentialLearningRate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Simple class that allows to grow learning rate exponentially during training.
Used to trigger optimal learning rate search in deepof.train_utils.find_learning_rate.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ExponentialLearningRate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ExponentialLearningRate.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the exponential learning rate callback</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>factor</strong> (<em>float</em>) – factor by which to multiply the learning rate</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ExponentialLearningRate.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ExponentialLearningRate.on_batch_end" title="Permalink to this definition"></a></dt>
<dd><p>This callback acts after processing each batch</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – batch number</p></li>
<li><p><strong>logs</strong> (<em>dict</em>) – dictionary containing the loss for the current batch</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ProbabilisticDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">ProbabilisticDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ProbabilisticDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Maps the reconstruction output of a given decoder to a multivariate normal distribution.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ProbabilisticDecoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ProbabilisticDecoder.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ProbabilisticDecoder.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ProbabilisticDecoder.call" title="Permalink to this definition"></a></dt>
<dd><p>Maps the reconstruction output of a given decoder to a multivariate normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>tuple</em>) – tuple containing the reconstruction output and the validity mask</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>multivariate normal distribution</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tf.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ClusterControl">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">ClusterControl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ClusterControl" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Identity layer that evaluates different clustering metrics between the components of the latent Gaussian Mixture
using the entropy of the nearest neighbourhood. If self.loss_weight &gt; 0, it also adds a regularization
penalty to the loss function which attempts to maximize the number of populated clusters during training.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ClusterControl.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ClusterControl.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the ClusterControl layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<em>int</em>) – batch size of the model</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – number of components in the latent Gaussian Mixture</p></li>
<li><p><strong>encoding_dim</strong> (<em>int</em>) – dimension of the latent Gaussian Mixture</p></li>
<li><p><strong>k</strong> (<em>int</em>) – number of nearest components of the latent Gaussian Mixture to consider</p></li>
<li><p><strong>loss_weight</strong> (<em>float</em>) – weight of the regularization penalty applied to the local entropy of each</p></li>
<li><p><strong>instance</strong> (<em>training</em>) – </p></li>
<li><p><strong>*args</strong> – additional positional arguments</p></li>
<li><p><strong>**kwargs</strong> – additional keyword arguments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ClusterControl.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ClusterControl.get_config" title="Permalink to this definition"></a></dt>
<dd><p>Updates Constraint metadata</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.ClusterControl.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.ClusterControl.call" title="Permalink to this definition"></a></dt>
<dd><p>Updates Layer’s call method</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.KLDivergenceLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">KLDivergenceLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.KLDivergenceLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">KLDivergenceAddLoss</span></code></p>
<p>Identity transform layer that adds KL Divergence
to the final model loss.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.KLDivergenceLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_up_iters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annealing_mode</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.KLDivergenceLayer.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the KL Divergence layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iters</strong> (<em>int</em>) – number of training iterations taken so far</p></li>
<li><p><strong>warm_up_iters</strong> (<em>int</em>) – maximum number of training iterations for warmup</p></li>
<li><p><strong>annealing_mode</strong> (<em>str</em>) – mode of annealing, either ‘linear’ or ‘sigmoid’</p></li>
<li><p><strong>*args</strong> – additional positional arguments</p></li>
<li><p><strong>**kwargs</strong> – additional keyword arguments</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.KLDivergenceLayer.get_config">
<span class="sig-name descname"><span class="pre">get_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.KLDivergenceLayer.get_config" title="Permalink to this definition"></a></dt>
<dd><p>Updates Constraint metadata</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.KLDivergenceLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution_a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.KLDivergenceLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>Updates Layer’s call method</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerEncoderLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">TransformerEncoderLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerEncoderLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Transformer encoder layer. Based on <a class="reference external" href="https://www.tensorflow.org/text/tutorials/transformer">https://www.tensorflow.org/text/tutorials/transformer</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerEncoderLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerEncoderLayer.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor for the transformer encoder layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_dim</strong> – dimensionality of the time series</p></li>
<li><p><strong>num_heads</strong> – number of heads of the multi-head-attention layers</p></li>
<li><p><strong>dff</strong> – dimensionality of the embeddings</p></li>
<li><p><strong>rate</strong> – dropout rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerEncoderLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerEncoderLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first invocation,
wrapping the creation of variables or other resources in <cite>tf.init_scope()</cite>).
It is recommended to create state in <cite>__init__()</cite>, or the <cite>build()</cite> method
that is called automatically before <cite>call()</cite> executes the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong> – Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong> – <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerDecoderLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">TransformerDecoderLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerDecoderLayer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Transformer decoder layer. Based on <a class="reference external" href="https://www.tensorflow.org/text/tutorials/transformer">https://www.tensorflow.org/text/tutorials/transformer</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerDecoderLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerDecoderLayer.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor for the transformer decoder layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key_dim</strong> – dimensionality of the time series</p></li>
<li><p><strong>num_heads</strong> – number of heads of the multi-head-attention layers</p></li>
<li><p><strong>dff</strong> – dimensionality of the embeddings</p></li>
<li><p><strong>rate</strong> – dropout rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerDecoderLayer.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">look_ahead_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerDecoderLayer.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first invocation,
wrapping the creation of variables or other resources in <cite>tf.init_scope()</cite>).
It is recommended to create state in <cite>__init__()</cite>, or the <cite>build()</cite> method
that is called automatically before <cite>call()</cite> executes the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong> – Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong> – <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">TransformerEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerEncoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Transformer encoder. Based on <a class="reference external" href="https://www.tensorflow.org/text/tutorials/transformer">https://www.tensorflow.org/text/tutorials/transformer</a>.
Adapted according to <a class="reference external" href="https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true">https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true</a>
and <a class="reference external" href="https://arxiv.org/abs/1711.03905">https://arxiv.org/abs/1711.03905</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerEncoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_position_encoding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerEncoder.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor for the transformer encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_layers</strong> – number of transformer layers to include.</p></li>
<li><p><strong>seq_dim</strong> – dimensionality of the sequence embeddings</p></li>
<li><p><strong>key_dim</strong> – dimensionality of the time series</p></li>
<li><p><strong>num_heads</strong> – number of heads of the multi-head-attention layers used on the transformer encoder</p></li>
<li><p><strong>dff</strong> – dimensionality of the token embeddings</p></li>
<li><p><strong>maximum_position_encoding</strong> – maximum time series length</p></li>
<li><p><strong>rate</strong> – dropout rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerEncoder.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerEncoder.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first invocation,
wrapping the creation of variables or other resources in <cite>tf.init_scope()</cite>).
It is recommended to create state in <cite>__init__()</cite>, or the <cite>build()</cite> method
that is called automatically before <cite>call()</cite> executes the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong> – Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong> – <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">TransformerDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></p>
<p>Transformer decoder. Based on <a class="reference external" href="https://www.tensorflow.org/text/tutorials/transformer">https://www.tensorflow.org/text/tutorials/transformer</a>.
Adapted according to <a class="reference external" href="https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true">https://academic.oup.com/gigascience/article/8/11/giz134/5626377?login=true</a>
and <a class="reference external" href="https://arxiv.org/abs/1711.03905">https://arxiv.org/abs/1711.03905</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerDecoder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seq_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_position_encoding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerDecoder.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor for the transformer decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_layers</strong> – number of transformer layers to include.</p></li>
<li><p><strong>seq_dim</strong> – dimensionality of the sequence embeddings</p></li>
<li><p><strong>key_dim</strong> – dimensionality of the time series</p></li>
<li><p><strong>num_heads</strong> – number of heads of the multi-head-attention layers used on the transformer encoder</p></li>
<li><p><strong>dff</strong> – dimensionality of the token embeddings</p></li>
<li><p><strong>maximum_position_encoding</strong> – maximum time series length</p></li>
<li><p><strong>rate</strong> – dropout rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.TransformerDecoder.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enc_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">look_ahead_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.TransformerDecoder.call" title="Permalink to this definition"></a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first invocation,
wrapping the creation of variables or other resources in <cite>tf.init_scope()</cite>).
It is recommended to create state in <cite>__init__()</cite>, or the <cite>build()</cite> method
that is called automatically before <cite>call()</cite> executes the first time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – <p>Input tensor, or dict/list/tuple of input tensors.
The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul>
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite> only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</p></li>
<li><p><strong>*args</strong> – Additional positional arguments. May contain tensors, although
this is not recommended, for the reasons above.</p></li>
<li><p><strong>**kwargs</strong> – <p>Additional keyword arguments. May contain tensors, although
this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul>
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask generated
for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come from a layer
that generated a corresponding mask, i.e. if it came from a Keras
layer with masking support).</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.log_hyperparameters">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">log_hyperparameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.log_hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Blueprint for hyperparameter and metric logging in tensorboard during hyperparameter tuning</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List containing the hyperparameters to log in tensorboard.
metrics (list): List containing the metrics to log in tensorboard.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>logparams (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.autoencoder_fitting">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">autoencoder_fitting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessed_object</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kmeans_loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_annealing_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_warmup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_cat_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Strategy</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'one_device'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.unsupervised_utils.autoencoder_fitting" title="Permalink to this definition"></a></dt>
<dd><p>Trains the specified autoencoder on the preprocessed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preprocessed_object</strong> (<em>tuple</em>) – Tuple containing the preprocessed data.</p></li>
<li><p><strong>embedding_model</strong> (<em>str</em>) – Model to use to embed and cluster the data. Must be one of VQVAE (default), GMVAE,</p></li>
<li><p><strong>contrastive.</strong> (<em>and</em>) – </p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size to use for training.</p></li>
<li><p><strong>latent_dim</strong> (<em>int</em>) – Encoding size to use for training.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of epochs to train the autoencoder for.</p></li>
<li><p><strong>log_history</strong> (<em>bool</em>) – Whether to log the history of the autoencoder.</p></li>
<li><p><strong>log_hparams</strong> (<em>bool</em>) – Whether to log the hyperparameters used for training.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of components to fit to the data.</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – Path to the output directory.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – Weight of the gram loss, which adds a regularization term to VQVAE models which</p></li>
<li><p><strong>space.</strong> (<em>penalizes the correlation between the dimensions in the latent</em>) – </p></li>
<li><p><strong>pretrained</strong> (<em>str</em>) – Path to the pretrained weights to use for the autoencoder.</p></li>
<li><p><strong>save_checkpoints</strong> (<em>bool</em>) – Whether to save checkpoints during training.</p></li>
<li><p><strong>save_weights</strong> (<em>bool</em>) – Whether to save the weights of the autoencoder after training.</p></li>
<li><p><strong>input_type</strong> (<em>str</em>) – Input type of the TableDict objects used for preprocessing. For logging purposes only.</p></li>
<li><p><strong>run</strong> (<em>int</em>) – Run number to use for logging.</p></li>
<li><p><strong>strategy</strong> (<em>tf.distribute.Strategy</em>) – Distribution strategy to use for training.</p></li>
<li><p><strong>parameters</strong> (<em># GMVAE Model specific</em>) – </p></li>
<li><p><strong>kl_annealing_mode</strong> (<em>str</em>) – Mode to use for KL annealing. Must be one of “linear” (default), or “sigmoid”.</p></li>
<li><p><strong>kl_warmup</strong> (<em>int</em>) – Number of epochs during which KL is annealed.</p></li>
<li><p><strong>reg_cat_clusters</strong> (<em>bool</em>) – whether to use the penalize uneven cluster membership in the latent space, by</p></li>
<li><p><strong>distribution.</strong> (<em>minimizing the KL divergence between cluster membership and a uniform categorical</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of trained models corresponding to the selected model class. The full trained model is last.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.unsupervised_utils.tune_search">
<span class="sig-prename descclassname"><span class="pre">deepof.unsupervised_utils.</span></span><span class="sig-name descname"><span class="pre">tune_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hypertun_trials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hpt_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_replicas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'unsupervised_tuner_search'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="headerlink" href="#deepof.unsupervised_utils.tune_search" title="Permalink to this definition"></a></dt>
<dd><p>Define the search space using keras-tuner and hyperband or bayesian optimization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>tf.data.Dataset</em>) – Dataset object for training and validation.</p></li>
<li><p><strong>encoding_size</strong> (<em>int</em>) – Size of the encoding layer.</p></li>
<li><p><strong>embedding_model</strong> (<em>str</em>) – Model to use to embed and cluster the data. Must be one of VQVAE (default), GMVAE,</p></li>
<li><p><strong>contrastive.</strong> (<em>and</em>) – </p></li>
<li><p><strong>hypertun_trials</strong> (<em>int</em>) – Number of hypertuning trials to run.</p></li>
<li><p><strong>hpt_type</strong> (<em>str</em>) – Type of hypertuning to run. Must be one of “hyperband” or “bayesian”.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of clusters on the latent space.</p></li>
<li><p><strong>kmeans_loss</strong> (<em>float</em>) – Weight of the kmeans loss, which enforces disentanglement by penalizing the correlation</p></li>
<li><p><strong>space.</strong> (<em>between dimensions in the latent</em>) – </p></li>
<li><p><strong>project_name</strong> (<em>str</em>) – Name of the project.</p></li>
<li><p><strong>callbacks</strong> (<em>List</em>) – List of callbacks to use.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size to use.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em>) – Maximum number of epochs to train for.</p></li>
<li><p><strong>n_replicas</strong> (<em>int</em>) – Number of replicas to use.</p></li>
<li><p><strong>outpath</strong> (<em>str</em>) – Path to save the results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of the best hyperparameters.
best_run (str): Name of the best run.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>best_hparams (dict)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepof.utils">
<span id="deepof-utils-module"></span><h2>deepof.utils module<a class="headerlink" href="#module-deepof.utils" title="Permalink to this heading"></a></h2>
<p>Functions and general utilities for the deepof package.</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.connect_mouse_topview">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">connect_mouse_topview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">animal_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Graph</span></span></span><a class="headerlink" href="#deepof.utils.connect_mouse_topview" title="Permalink to this definition"></a></dt>
<dd><p>Creates a nx.Graph object with the connectivity of the bodyparts in the
DLC topview model for a single mouse. Used later for angle computing, among others.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>animal_id</strong> (<em>str</em>) – if more than one animal is tagged, specify the animal identyfier as a string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>connectivity (nx.Graph)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.str2bool">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">str2bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#deepof.utils.str2bool" title="Permalink to this definition"></a></dt>
<dd><p>Returns the passed string as a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<em>str</em>) – String to transform to boolean value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bool. If conversion is not possible, it raises an error</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.likelihood_qc">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">likelihood_qc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.likelihood_qc" title="Permalink to this definition"></a></dt>
<dd><p>Returns a DataFrame filtered dataframe, keeping only the rows entirely above the threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dframe</strong> (<em>pandas.DataFrame</em>) – DeepLabCut output, with positions over time and associated likelihood.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Minimum acceptable confidence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mask on the rows of dframe</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filt_mask (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.bp2polar">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">bp2polar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.bp2polar" title="Permalink to this definition"></a></dt>
<dd><p>Returns the DataFrame in polar coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tab</strong> (<em>pandas.DataFrame</em>) – Table with cartesian coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Equivalent to input, but with values in polar coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>polar (pandas.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.tab2polar">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">tab2polar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cartesian_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.tab2polar" title="Permalink to this definition"></a></dt>
<dd><p>Returns a pandas.DataFrame in which all the coordinates are polar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cartesian_df</strong> (<em>pandas.DataFrame</em>) – DataFrame containing tables with cartesian coordinates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Equivalent to input, but with values in polar coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>result (pandas.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.compute_dist">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">compute_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pair_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_rel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.compute_dist" title="Permalink to this definition"></a></dt>
<dd><p>Returns a pandas.DataFrame with the scaled distances between a pair of body parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pair_array</strong> (<em>numpy.array</em>) – np.array of shape N * 4 containing X, y positions.</p></li>
<li><p><strong>parts.</strong> (<em>over time for a given pair</em><em> of </em><em>body</em>) – </p></li>
<li><p><strong>arena_abs</strong> (<em>int</em>) – Diameter of the real arena in cm.</p></li>
<li><p><strong>arena_rel</strong> (<em>int</em>) – Diameter of the captured arena in pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame with the absolute distances between a pair of body parts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>result (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.bpart_distance">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">bpart_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_abs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_rel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.bpart_distance" title="Permalink to this definition"></a></dt>
<dd><p>Returns a pandas.DataFrame with the scaled distances between all pairs of body parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pandas.DataFrame</em>) – pd.DataFrame of shape N*(2*bp) containing X,y positions</p></li>
<li><p><strong>parts.</strong> (<em>over time for a given set</em><em> of </em><em>bp body</em>) – </p></li>
<li><p><strong>arena_abs</strong> (<em>int</em>) – Diameter of the real arena in cm.</p></li>
<li><p><strong>arena_rel</strong> (<em>int</em>) – Diameter of the captured arena in pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame with the absolute distances between all pairs of body parts.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>result (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.angle">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.angle" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy.array with the angles between the provided instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>np.array</em>) – 2D positions over time for a body part.</p></li>
<li><p><strong>b</strong> (<em>np.array</em>) – 2D positions over time for a body part.</p></li>
<li><p><strong>c</strong> (<em>np.array</em>) – 2D positions over time for a body part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D angles between the three-point-instances.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ang (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.angle_trio">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">angle_trio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bpart_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.angle_trio" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy.array with all three possible angles between the provided instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bpart_array</strong> (<em>numpy.array</em>) – 2D positions over time for a bodypart.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D all-three angles between the three-point-instances.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ang_trio (numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.compute_areas">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">compute_areas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">animal_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.utils.compute_areas" title="Permalink to this definition"></a></dt>
<dd><p>Computes relevant areas (head, torso, back, full) for the provided coordinates.
:param coords: coordinates of the body parts for a single time point.
:param animal_id: animal id for the provided coordinates, if any.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>list including head, torso, back, and full areas for the provided coordinates.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>areas</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.rotate">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.rotate" title="Permalink to this definition"></a></dt>
<dd><p>Returns a 2D numpy.ndarray with the initial values rotated by angles radians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>numpy.ndarray</em>) – 2D Array containing positions of bodyparts over time.</p></li>
<li><p><strong>angles</strong> (<em>numpy.ndarray</em>) – Set of angles (in radians) to rotate p with.</p></li>
<li><p><strong>origin</strong> (<em>numpy.ndarray</em>) – Rotation axis (zero vector by default).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rotated positions over time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>rotated (numpy.ndarray)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.align_trajectories">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">align_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.align_trajectories" title="Permalink to this definition"></a></dt>
<dd><p>Returns a numpy.array with the positions rotated in a way that the center (0 vector)
and the body part in the first column of data are aligned with the y axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – 3D array containing positions of body parts over time, where</p></li>
<li><p><strong>N</strong> (<em>shape is</em>) – </p></li>
<li><p><strong>mode</strong> (<em>string</em>) – Specifies if <em>all</em> instances of each sliding window get</p></li>
<li><p><strong>aligned</strong> – </p></li>
<li><p><strong>center</strong> (<em>or only the</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D aligned positions over time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>aligned_trajs (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.kleinberg">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">kleinberg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.718281828459045</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.utils.kleinberg" title="Permalink to this definition"></a></dt>
<dd><p>Kleinberg’s algorithm (described in ‘Bursty and Hierarchical Structure
in Streams’). The algorithm models activity bursts in a time series as an
infinite hidden Markov model.</p>
<p>Taken from pybursts (<a class="reference external" href="https://github.com/romain-fontugne/pybursts/blob/master/pybursts/pybursts.py">https://github.com/romain-fontugne/pybursts/blob/master/pybursts/pybursts.py</a>)
and adapted for dependency compatibility reasons.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>offsets: a list of time offsets (numeric)
s: the base of the exponential distribution that is used for modeling
the event frequencies
gamma: coefficient for the transition costs between states
n, T: to have a fixed cost function (not dependent of the given offsets).
Which is needed if you want to compare bursts for different inputs.
k: maximum burst level</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.smooth_boolean_array">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">smooth_boolean_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.smooth_boolean_array" title="Permalink to this definition"></a></dt>
<dd><p>Returns a boolean array in which isolated appearances of a feature are smoothed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>numpy.ndarray</em>) – Boolean instances.</p></li>
<li><p><strong>scale</strong> (<em>int</em>) – Kleinberg scale parameter. Higher values result in stricter smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Smoothened boolean instances.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a (numpy.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.split_with_breakpoints">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">split_with_breakpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breakpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#deepof.utils.split_with_breakpoints" title="Permalink to this definition"></a></dt>
<dd><p>Split a numpy.ndarray at the given breakpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>np.ndarray</em>) – N (instances) * m (features) shape</p></li>
<li><p><strong>breakpoints</strong> (<em>list</em>) – list of breakpoints obtained with ruptures</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>padded array of shape N (instances) * l (maximum break length) * m (features)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>split_a (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.rolling_window">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">rolling_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automatic_changepoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precomputed_breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#deepof.utils.rolling_window" title="Permalink to this definition"></a></dt>
<dd><p>Returns a 3D numpy.array with a sliding-window extra dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>np.ndarray</em>) – N (instances) * m (features) shape</p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – Size of the window to apply</p></li>
<li><p><strong>window_step</strong> (<em>int</em>) – Step of the window to apply</p></li>
<li><p><strong>automatic_changepoints</strong> (<em>str</em>) – Changepoint detection algorithm to apply.</p></li>
<li><p><strong>False</strong> (<em>If</em>) – </p></li>
<li><p><strong>window.</strong> (<em>applies a fixed sliding</em>) – </p></li>
<li><p><strong>precomputed_breaks</strong> (<em>np.ndarray</em>) – Precomputed breaks to use, bypassing the changepoint detection algorithm.</p></li>
<li><p><strong>default</strong> (<em>None by</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N (sliding window instances) * l (sliding window size) * m (features)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rolled_a (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.rupture_per_experiment">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">rupture_per_experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">deepof_table_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_rupture</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rupture_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automatic_changepoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precomputed_breaks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#deepof.utils.rupture_per_experiment" title="Permalink to this definition"></a></dt>
<dd><p>Apply the rupture method independently to each experiment, and concatenate into a single dataset
at the end. Returns a dataset and the rupture indices, adapted to be used in a concatenated version
of the labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_dict</strong> (<em>deepof.data.table_dict</em>) – table_dict with all experiments.</p></li>
<li><p><strong>to_rupture</strong> (<em>np.ndarray</em>) – Array with dataset to rupture.</p></li>
<li><p><strong>rupture_indices</strong> (<em>list</em>) – Indices of tables to rupture. Useful to select training and test sets.</p></li>
<li><p><strong>automatic_changepoints</strong> (<em>str</em>) – Rupture method to apply.</p></li>
<li><p><strong>false</strong> (<em>If</em>) – </p></li>
<li><p><strong>obtained.</strong> (<em>a sliding window</em><em> of </em><em>window_length * window_size is</em>) – </p></li>
<li><p><strong>&quot;l1&quot;</strong> (<em>If one of</em>) – </p></li>
<li><p><strong>&quot;rbf&quot;</strong> (<em>&quot;l2&quot; or</em>) – </p></li>
<li><p><strong>applied</strong> (<em>different automatic change point detection algorithms are</em>) – </p></li>
<li><p><strong>experiment.</strong> (<em>on each independent</em>) – </p></li>
<li><p><strong>window_size</strong> (<em>int</em>) – If automatic_changepoints is False, specifies the length of the sliding window.</p></li>
<li><p><strong>not</strong> (<em>If</em>) – </p></li>
<li><p><strong>breaks.</strong> (<em>it determines the minimum step size</em><em> of </em><em>the obtained time series</em>) – </p></li>
<li><p><strong>window_step</strong> (<em>int</em>) – If automatic_changepoints is False, specifies the stride of the sliding window.</p></li>
<li><p><strong>not</strong> – </p></li>
<li><p><strong>breaks.</strong> – </p></li>
<li><p><strong>precomputed_breaks</strong> (<em>dict</em>) – If provided, changepoint detection is prevented, and provided breaks are used instead.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset with all ruptures concatenated across the first axis.
rupture_indices (list): Indices of ruptures.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ruptured_dataset (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.smooth_mult_trajectory">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">smooth_mult_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#deepof.utils.smooth_mult_trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Returns a smoothed a trajectory using a Savitzky-Golay 1D filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>numpy.ndarray</em>) – 1D trajectory array with N (instances)</p></li>
<li><p><strong>alpha</strong> (<em>int</em>) – 0 &lt;= alpha &lt; w_length; indicates the difference between the degree of the polynomial and the window</p></li>
<li><p><strong>fit</strong> (<em>length for the Savitzky-Golay filter used for smoothing. Higher values produce a worse</em>) – </p></li>
<li><p><strong>smoothing.</strong> (<em>hence more</em>) – </p></li>
<li><p><strong>w_length</strong> (<em>int</em>) – Length of the sliding window to which the filter fit. Higher values yield a coarser fit,</p></li>
<li><p><strong>smoothing.</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>smoothed version of the input, with equal shape</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>smoothed_series (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.moving_average">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">moving_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#deepof.utils.moving_average" title="Permalink to this definition"></a></dt>
<dd><p>Fast implementation of a moving average function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<em>pd.Series</em>) – Uni-variate time series to take the moving average of.</p></li>
<li><p><strong>lag</strong> (<em>int</em>) – size of the convolution window used to compute the moving average.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Uni-variate moving average over time_series.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>moving_avg (pd.Series)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.mask_outliers">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">mask_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.mask_outliers" title="Permalink to this definition"></a></dt>
<dd><p>Returns a mask over the bivariate trajectory of a body part, identifying as True all detected outliers.
An outlier can be marked with one of two criteria: 1) the likelihood reported by DLC is below likelihood_tolerance,
and/or 2) the deviation from a moving average model is greater than n_std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series</strong> (<em>pd.DataFrame</em>) – Bi-variate time series representing the x, y positions of a single body part</p></li>
<li><p><strong>likelihood</strong> (<em>pd.DataFrame</em>) – Data frame with likelihood data per body part as extracted from deeplabcut</p></li>
<li><p><strong>likelihood_tolerance</strong> (<em>float</em>) – Minimum tolerated likelihood, below which an outlier is called</p></li>
<li><p><strong>lag</strong> (<em>int</em>) – Size of the convolution window used to compute the moving average</p></li>
<li><p><strong>n_std</strong> (<em>int</em>) – Number of standard deviations over the moving average to be considered an outlier</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – If “and” (default) both x and y have to be marked in order to call an outlier. If “or”, one is enough.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>mask (pd.DataFrame): Bi-variate mask over time_series. True indicates an outlier.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.full_outlier_mask">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">full_outlier_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.full_outlier_mask" title="Permalink to this definition"></a></dt>
<dd><p>Iterates over all body parts of experiment, and outputs a dataframe where all x, y positions are
replaced by a boolean mask, where True indicates an outlier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<em>pd.DataFrame</em>) – Data frame with time series representing the x, y positions of a every body part</p></li>
<li><p><strong>likelihood</strong> (<em>pd.DataFrame</em>) – Data frame with likelihood data per body part as extracted from deeplabcut</p></li>
<li><p><strong>likelihood_tolerance</strong> (<em>float</em>) – Minimum tolerated likelihood, below which an outlier is called</p></li>
<li><p><strong>exclude</strong> (<em>str</em>) – Body part to exclude from the analysis (to concatenate with bpart alignment)</p></li>
<li><p><strong>lag</strong> (<em>int</em>) – Size of the convolution window used to compute the moving average</p></li>
<li><p><strong>n_std</strong> (<em>int</em>) – Number of standard deviations over the moving average to be considered an outlier</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – If “and” (default) both x and y have to be marked in order to call an outlier. If “or”, one is enough.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mask over all body parts in experiment. True indicates an outlier</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>full_mask (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.interpolate_outliers">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">interpolate_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'or'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.interpolate_outliers" title="Permalink to this definition"></a></dt>
<dd><p>Marks all outliers in experiment and replaces them using a uni-variate linear interpolation approach.
Note that this approach only works for equally spaced data (constant camera acquisition rates).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<em>pd.DataFrame</em>) – Data frame with time series representing the x, y positions of a every body part.</p></li>
<li><p><strong>likelihood</strong> (<em>pd.DataFrame</em>) – Data frame with likelihood data per body part as extracted from deeplabcut.</p></li>
<li><p><strong>likelihood_tolerance</strong> (<em>float</em>) – Minimum tolerated likelihood, below which an outlier is called.</p></li>
<li><p><strong>exclude</strong> (<em>str</em>) – Body part to exclude from the analysis (to concatenate with bpart alignment).</p></li>
<li><p><strong>lag</strong> (<em>int</em>) – Size of the convolution window used to compute the moving average.</p></li>
<li><p><strong>n_std</strong> (<em>int</em>) – Number of standard deviations over the moving average to be considered an outlier.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – If “and” both x and y have to be marked in order to call an outlier. If “or” (default), one is enough.</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – Maximum of consecutive outliers to interpolate. Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated version of experiment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>interpolated_exp (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.filter_columns">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">filter_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#deepof.utils.filter_columns" title="Permalink to this definition"></a></dt>
<dd><p>Given a set of TableDict columns, returns those that correspond to a given animal, specified in selected_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> (<em>list</em>) – List of columns to filter.</p></li>
<li><p><strong>selected_id</strong> (<em>str</em>) – Animal ID to filter for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of filtered columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>filtered_columns (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.automatically_recognize_arena">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">automatically_recognize_arena</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">videos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vid_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recoglimit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high_fidelity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'circular-autodetect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rule-based'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnn_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Model</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.utils.automatically_recognize_arena" title="Permalink to this definition"></a></dt>
<dd><p>Returns numpy.array with information about the arena recognised from the first frames
of the video. WARNING: estimates won’t be reliable if the camera moves along the video.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>videos</strong> (<em>list</em>) – Relative paths of the videos to analise.</p></li>
<li><p><strong>vid_index</strong> (<em>int</em>) – Element of videos list to use.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Full path of the directory where the videos are.</p></li>
<li><p><strong>tables</strong> (<em>dict</em>) – Dictionary with DLC time series in DataFrames as values.</p></li>
<li><p><strong>recoglimit</strong> (<em>int</em>) – Number of frames to use for position estimates.</p></li>
<li><p><strong>high_fidelity</strong> (<em>bool</em>) – If True, runs arena recognition on the whole video. Slow, but</p></li>
<li><p><strong>conditions.</strong> (<em>potentially more accurate in poor lighting</em>) – </p></li>
<li><p><strong>arena_type</strong> (<em>string</em>) – Arena type; must be one of [‘circular-autodetect’, ‘circular-manual’, ‘polygon-manual’].</p></li>
<li><p><strong>detection_mode</strong> (<em>str</em>) – Algorithm to use to detect the arena. “cnn” uses a</p></li>
<li><p><strong>from</strong> (<em>pretrained model based on ResNet50 to predict the ellipse parameters</em>) – </p></li>
<li><p><strong>&quot;rule-based&quot;</strong> (<em>the image.</em>) – </p></li>
<li><p><strong>cnn_model</strong> (<em>tf.keras.models.Model</em>) – Model to use if detection_mode==”cnn”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D-array containing information about the arena.
“circular-autodetect” (3-element-array) -&gt; x-y position of the center and the radius.
“circular-manual” (3-element-array) -&gt; x-y position of the center and the radius.
“polygon-manual” (2n-element-array) -&gt; x-y position of each of the n the vertices of the polygon.
h (int): Height of the video in pixels.
w (int): Width of the video in pixels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>arena (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.retrieve_corners_from_image">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">retrieve_corners_from_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.utils.retrieve_corners_from_image" title="Permalink to this definition"></a></dt>
<dd><p>Opens a window and waits for the user to click on all corners of the polygonal arena.
The user should click on the corners in sequential order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>np.ndarray</em>) – Frame to display.</p></li>
<li><p><strong>arena_type</strong> (<em>str</em>) – Type of arena to be used. Must be one of the following: “circular-manual”, “polygon-manual”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>nx2 array containing the x-y coordinates of all n corners.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>corners (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.extract_polygonal_arena_coordinates">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">extract_polygonal_arena_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arena_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.utils.extract_polygonal_arena_coordinates" title="Permalink to this definition"></a></dt>
<dd><p>Reads a random frame from the selected video, and opens an interactive GUI to let the user delineate
the arena manually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video_path</strong> – Path to the video file.</p></li>
<li><p><strong>arena_type</strong> – Type of arena to be used. Must be one of the following: “circular-manual”, “polygon-manual”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>nx2 array containing the x-y coordinates of all n corners of the polygonal arena.
int: Height of the video.
int: Width of the video.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.fit_ellipse_to_polygon">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">fit_ellipse_to_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deepof.utils.fit_ellipse_to_polygon" title="Permalink to this definition"></a></dt>
<dd><p>Fits an ellipse to the provided polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>polygon</strong> – List of (x,y) coordinates of the corners of the polygon.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(x,y) coordinates of the center of the ellipse.
tuple: (a,b) semi-major and semi-minor axes of the ellipse.
float: Angle of the ellipse.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.circular_arena_recognition">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">circular_arena_recognition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rule-based'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cnn_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Model</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="headerlink" href="#deepof.utils.circular_arena_recognition" title="Permalink to this definition"></a></dt>
<dd><p>Returns x,y position of the center, the lengths of the major and minor axes,
and the angle of the recognised arena.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>np.ndarray</em>) – numpy.ndarray representing an individual frame of a video</p></li>
<li><p><strong>detection_mode</strong> (<em>str</em>) – Algorithm to use to detect the arena. “cnn” uses a</p></li>
<li><p><strong>from</strong> (<em>pretrained model based on ResNet50 to predict the ellipse parameters</em>) – </p></li>
<li><p><strong>simpler</strong> (<em>the image. &quot;rule-based&quot; uses a</em>) – </p></li>
<li><p><strong>cnn_model</strong> (<em>tf.keras.models.Model</em>) – Model to use if detection_mode==”cnn”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3-element-array containing x,y positions of the center
of the arena, and a third value indicating the radius.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>circles (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.rolling_speed">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">rolling_speed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DatetimeIndex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'coords'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#deepof.utils.rolling_speed" title="Permalink to this definition"></a></dt>
<dd><p>Returns the average speed over n frames in pixels per frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dframe</strong> (<em>pandas.DataFrame</em>) – Position over time dataframe.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Number of frames to average over.</p></li>
<li><p><strong>rounds</strong> (<em>int</em>) – Float rounding decimals.</p></li>
<li><p><strong>deriv</strong> (<em>int</em>) – Position derivative order; 1 for speed, 2 for acceleration, 3 for jerk, etc.</p></li>
<li><p><strong>center</strong> (<em>str</em>) – For internal usage only; solves an issue with pandas.MultiIndex that arises when centering frames</p></li>
<li><p><strong>part.</strong> (<em>to a specific body</em>) – </p></li>
<li><p><strong>shift</strong> (<em>int</em>) – Window shift for rolling speed calculation.</p></li>
<li><p><strong>typ</strong> (<em>str</em>) – Type of dataset. Intended for internal usage only.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Data frame containing 2D speeds for each body part in the original data or their
consequent derivatives.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>speeds (pd.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.gmm_compute">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">gmm_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#deepof.utils.gmm_compute" title="Permalink to this definition"></a></dt>
<dd><p>Fits a Gaussian Mixture Model to the provided data and returns evaluation metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Data matrix to train the model</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of Gaussian components to use</p></li>
<li><p><strong>cv_type</strong> (<em>str</em>) – Covariance matrix type to use.</p></li>
<li><p><strong>&quot;spherical&quot;</strong> (<em>Must be one of</em>) – </p></li>
<li><p><strong>&quot;tied&quot;</strong> – </p></li>
<li><p><strong>&quot;diag&quot;</strong> – </p></li>
<li><p><strong>&quot;full&quot;.</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>model and associated BIC for downstream selection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>gmm_eval (list)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.gmm_model_selection">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">gmm_model_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('spherical',</span> <span class="pre">'tied',</span> <span class="pre">'diag',</span> <span class="pre">'full')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.utils.gmm_model_selection" title="Permalink to this definition"></a></dt>
<dd><p>Runs GMM clustering model selection on the specified X dataframe, outputs the bic distribution per model,
a vector with the median BICs and an object with the overall best model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pandas.DataFrame</em>) – Data matrix to train the models</p></li>
<li><p><strong>n_components_range</strong> (<em>range</em>) – Generator with numbers of components to evaluate</p></li>
<li><p><strong>n_runs</strong> (<em>int</em>) – Number of bootstraps for each model</p></li>
<li><p><strong>part_size</strong> (<em>int</em>) – Size of bootstrap samples for each model</p></li>
<li><p><strong>n_cores</strong> (<em>int</em>) – Number of cores to use for computation</p></li>
<li><p><strong>cv_types</strong> (<em>tuple</em>) – Covariance Matrices to try. All four available by default</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All recorded BIC values for all attempted parameter combinations
(useful for plotting)
- m_bic(list): All minimum BIC values recorded throughout the process
(useful for plottinh)
- best_bic_gmm (sklearn.GMM): Unfitted version of the best found model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>bic (list)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.utils.cluster_transition_matrix">
<span class="sig-prename descclassname"><span class="pre">deepof.utils.</span></span><span class="sig-name descname"><span class="pre">cluster_transition_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nclusts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocorrelation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Graph</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deepof.utils.cluster_transition_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Computes the transition matrix between clusters and the autocorrelation in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_sequence</strong> (<em>numpy.array</em>) – Sequence of cluster assignments.</p></li>
<li><p><strong>nclusts</strong> (<em>int</em>) – Number of clusters in the sequence.</p></li>
<li><p><strong>autocorrelation</strong> (<em>bool</em>) – Whether to compute the autocorrelation of the sequence.</p></li>
<li><p><strong>return_graph</strong> (<em>bool</em>) – Whether to return the transition matrix as an networkx.DiGraph object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transition matrix as numpy.ndarray or networkx.DiGraph.
autocorr (numpy.array): If autocorrelation is True, returns a numpy.ndarray with all autocorrelation
values on cluster assignment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>trans_normed (numpy.ndarray / networkx.Graph)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepof.visuals">
<span id="deepof-visuals-module"></span><h2>deepof.visuals module<a class="headerlink" href="#module-deepof.visuals" title="Permalink to this heading"></a></h2>
<p>General plotting functions for the deepof package</p>
<dl class="py function">
<dt class="sig sig-object py" id="deepof.visuals.plot_heatmap">
<span class="sig-prename descclassname"><span class="pre">deepof.visuals.</span></span><span class="sig-name descname"><span class="pre">plot_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bodyparts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">figure</span></span></span><a class="headerlink" href="#deepof.visuals.plot_heatmap" title="Permalink to this definition"></a></dt>
<dd><p>Returns a heatmap of the movement of a specific bodypart in the arena.
If more than one bodypart is passed, it returns one subplot for each</p>
<blockquote>
<div><dl class="simple">
<dt>Parameters:</dt><dd><ul class="simple">
<li><p>dframe (pandas.DataFrame): table_dict value with info to plot</p></li>
<li><p>bodyparts (List): bodyparts to represent (at least 1)</p></li>
<li><p>xlim (float): limits of the x-axis</p></li>
<li><p>ylim (float): limits of the y-axis</p></li>
<li><p>save (str): name of the file to which the figure should be saved</p></li>
<li><p>dpi (int): dots per inch of the returned image</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>heatmaps (plt.figure): figure with the specified characteristics</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.visuals.plot_projection">
<span class="sig-prename descclassname"><span class="pre">deepof.visuals.</span></span><span class="sig-name descname"><span class="pre">plot_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">figure</span></span></span><a class="headerlink" href="#deepof.visuals.plot_projection" title="Permalink to this definition"></a></dt>
<dd><p>Returns a scatter plot of the passed projection. Each dot represents the trajectory of an entire animal.
If labels are propagated, it automatically colours all data points with their respective condition.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>projection (tuple): tuple containing the projection and the associated conditions when available</p></li>
<li><p>save (str): name of the file to which the figure should be saved</p></li>
<li><p>dpi (int): dots per inch of the returned image</p></li>
</ul>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>projection_scatter (plt.figure): figure with the specified characteristics</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepof.visuals.plot_unsupervised_embeddings">
<span class="sig-prename descclassname"><span class="pre">deepof.visuals.</span></span><span class="sig-name descname"><span class="pre">plot_unsupervised_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">figure</span></span></span><a class="headerlink" href="#deepof.visuals.plot_unsupervised_embeddings" title="Permalink to this definition"></a></dt>
<dd><p>Returns a scatter plot of the passed projection. Each dot represents the trajectory of an entire animal.
If labels are propagated, it automatically colours all data points with their respective condition.</p>
<blockquote>
<div><dl>
<dt>Parameters:</dt><dd><ul class="simple">
<li><p>embeddings (tuple): sequence embeddings obtained with the unsupervised pipeline within deepof</p></li>
<li><p>exp_labels (tuple): labels of the experiments. If None, aggregation method must be None as well.</p></li>
<li><p>cluster_labels (tuple): labels of the clusters. If None, aggregation method should be provided.</p></li>
<li><p>aggregation_method (str): method to aggregate the data. If None, exp_labels must be None as well.</p></li>
</ul>
<p>Must be one of [None, “mean”, “cluster_population”].</p>
</dd>
<dt>Returns:</dt><dd><ul class="simple">
<li><p>projection_scatter (plt.figure): figure with the specified characteristics</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</section>
<section id="module-deepof">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-deepof" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Lucas Miranda.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>